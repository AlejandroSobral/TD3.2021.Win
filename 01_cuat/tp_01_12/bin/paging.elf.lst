     1                                  %include "inc/processor-flags.h" 
     1                              <1> %define X86_CR0_PE      0x00000001 ;/* Protectede mode enable*/
     2                              <1> %define X86_CR0_MP      0x00000002 ;/* Monitor coProcessor*/
     3                              <1> %define X86_CR0_EM      0x00000004 ;/* Emulation*/
     4                              <1> %define X86_CR0_TS      0x00000008 ;/* Task Switched*/
     5                              <1> %define X86_CR0_ET      0x00000010 ;/* Extension Type*/
     6                              <1> %define X86_CR0_NE      0x00000020 ;/* Numeric Error*/
     7                              <1> %define X86_CR0_WP      0x00010000 ;/* Write Protect*/
     8                              <1> %define X86_CR0_AM      0x00040000 ;/* Alignment Mask*/
     9                              <1> %define X86_CR0_NW      0x20000000 ;/* Not Write-through*/
    10                              <1> %define X86_CR0_CD      0x40000000 ;/* Cache Disable*/
    11                              <1> %define X86_CR0_PG      0x80000000 ;/* PaGine*/
    12                              <1> 
    13                              <1> %define IDLE            0x00000000;
    14                              <1> %define WAITING         0x00000001;
    15                              <1> %define RUNNING         0x00000002;
     2                                  %include "inc/defines.h" 
     1                              <1> 
     2                              <1> %define PORT_A_8042    0x60
     3                              <1> %define CTRL_PORT_8042 0x64
     4                              <1> %define KEYB_DIS       0xAD
     5                              <1> %define KEYB_EN        0xAE
     6                              <1> %define READ_OUT_8042  0xD0
     7                              <1> %define WRITE_OUT_8042 0xD1
     8                              <1> 
     9                              <1> 
    10                              <1> %define TECLA_1     0x02
    11                              <1> %define TECLA_2     0x03
    12                              <1> %define TECLA_3     0x04
    13                              <1> %define TECLA_4     0x05
    14                              <1> %define TECLA_5     0x06
    15                              <1> %define TECLA_6     0x07
    16                              <1> %define TECLA_7     0x08
    17                              <1> %define TECLA_8     0x09
    18                              <1> %define TECLA_9     0x0A
    19                              <1> %define TECLA_0     0x0B
    20                              <1> 
    21                              <1> %define TECLA_ENTER 0x1C
    22                              <1> 
    23                              <1> %define TECLA_A     0x1E
    24                              <1> %define TECLA_B     0x30
    25                              <1> %define TECLA_C     0x2E
    26                              <1> %define TECLA_D     0x20
    27                              <1> %define TECLA_E     0x12
    28                              <1> %define TECLA_F     0x21
    29                              <1> %define TECLA_G     0x22
    30                              <1> %define TECLA_H     0x23
    31                              <1> %define TECLA_I     0x17
    32                              <1> %define TECLA_J     0x24
    33                              <1> %define TECLA_K     0x25
    34                              <1> %define TECLA_L     0x26
    35                              <1> %define TECLA_M     0x32
    36                              <1> %define TECLA_N     0x31
    37                              <1> %define TECLA_O     0x18
    38                              <1> %define TECLA_P     0x19
    39                              <1> %define TECLA_Q     0x10
    40                              <1> %define TECLA_R     0x13
    41                              <1> %define TECLA_S     0x1F
    42                              <1> %define TECLA_T     0x14
    43                              <1> %define TECLA_U     0x16
    44                              <1> %define TECLA_V     0x2F
    45                              <1> %define TECLA_W     0x11
    46                              <1> %define TECLA_X     0x2D
    47                              <1> %define TECLA_Y     0x15
    48                              <1> %define TECLA_Z     0x2C
    49                              <1> 
    50                              <1>  
     3                                  section .go_paging
     4                                  
     5                                  GLOBAL go_paging    
     6                                  EXTERN __SYS_TABLES_PHY      
     7                                  EXTERN __PAGE_TABLES_PHY     
     8                                  EXTERN __FUNCTIONS_PHY       
     9                                  EXTERN __VIDEO_PHY           
    10                                  EXTERN __ISR_AND_KEYBOARD_PHY
    11                                  EXTERN __DATA_PHY            
    12                                  EXTERN __TABLE_KEYBOARD_PHY  
    13                                  EXTERN __KERNEL_32_PHY       
    14                                  EXTERN __TASK_1_TEXT_PHY     
    15                                  EXTERN __TASK_1_BSS_PHY      
    16                                  EXTERN __TASK_1_DATA_PHY     
    17                                  EXTERN __TASK_1_RODATA_PHY   
    18                                  EXTERN __STACK_START_32_PHY  
    19                                  EXTERN __STACK_END_32_PHY    
    20                                  EXTERN __STACK_TASK1_PHY
    21                                  EXTERN __STACK_TASK1_VMA
    22                                  EXTERN __STACK_TASK2_VMA
    23                                  EXTERN __STACK_TASK3_VMA
    24                                  EXTERN __TASK_1_STACK_END_PHY
    25                                  EXTERN __SYS_TABLES_IDT
    26                                  EXTERN __PAGE_TABLES_VMA
    27                                  EXTERN __VIDEO_VMA
    28                                  EXTERN __load_DTP_entry_rom
    29                                  EXTERN __load_TP_entry_rom
    30                                  EXTERN __DATA_VMA
    31                                  EXTERN __INIT_16_VMA
    32                                  EXTERN __INIT_32_VMA
    33                                  EXTERN __STACK_START_32_VMA
    34                                  EXTERN __FUNCTIONS_VMA
    35                                  EXTERN __SYS_TABLES_VMA
    36                                  EXTERN __DATA_VMA
    37                                  EXTERN __ISR_AND_KEYBOARD_VMA
    38                                  EXTERN __KERNEL_32_VMA
    39                                  EXTERN __TASK_1_BSS_VMA
    40                                  EXTERN __TASK_1_RODATA_VMA
    41                                  EXTERN __TASK_1_TEXT_VMA
    42                                  EXTERN __TASK_1_DATA_VMA
    43                                  EXTERN __TABLE_KEYBOARD_VMA
    44                                  EXTERN __TASK_1_RODATA_PHY
    45                                  EXTERN __STACK_TASK1_VMA
    46                                  EXTERN __STACK_START_32
    47                                  EXTERN __CR3_KERNEL
    48                                  EXTERN __CR3_TASK1
    49                                  EXTERN __CR3_TASK2
    50                                  EXTERN __CR3_TASK3
    51                                  EXTERN __CR3_TASK4
    52                                  EXTERN LOAD_CR3_ROM
    53                                  EXTERN set_dtp_pt_merged_rom
    54                                  EXTERN __SYS_TABLES_TSS_PHY
    55                                  EXTERN __SYS_TABLES_PAG_PHY
    56                                  EXTERN __SYS_TABLES_PAG_VMA
    57                                  EXTERN __SYS_TABLES_LMA
    58                                  EXTERN turn_on_paging
    59                                  EXTERN __INIT_32_LMA
    60                                  EXTERN __TASK_3_RODATA_PHY
    61                                  EXTERN __TASK_3_RODATA_VMA
    62                                  EXTERN __TASK_2_TEXT_PHY
    63                                  EXTERN __TASK_2_TEXT_VMA
    64                                  EXTERN __TASK_3_TEXT_PHY
    65                                  EXTERN __TASK_3_TEXT_VMA
    66                                  EXTERN __SYS_TABLES_TSS_VMA
    67                                  EXTERN __STACK_START_32_PHY
    68                                  EXTERN __STACK_START_32
    69                                  EXTERN __STACK_TASK1_PHY
    70                                  EXTERN __STACK_TASK1_VMA
    71                                  EXTERN __SYS_TABLES_TSS_VMA
    72                                  EXTERN __STACK_KERNEL_T1_PHY
    73                                  EXTERN __STACK_KERNEL_T1_VMA
    74                                  EXTERN __TASK_1_TEXT_PHY
    75                                  EXTERN __TASK_2_TEXT_PHY
    76                                  EXTERN __TASK_3_TEXT_PHY
    77                                  EXTERN __TASK_4_TEXT_PHY
    78                                  EXTERN __TASK_1_TEXT_VMA
    79                                  EXTERN __TASK_2_TEXT_VMA
    80                                  EXTERN __TASK_3_TEXT_VMA
    81                                  EXTERN __TASK_4_TEXT_VMA
    82                                  EXTERN __TEXT_TASK2_PHY
    83                                  EXTERN __TEXT_TASK3_PHY
    84                                  EXTERN __TEXT_TASK4_PHY
    85                                  EXTERN __TEXT_TASK1_VMA
    86                                  EXTERN __TEXT_TASK2_VMA
    87                                  EXTERN __TEXT_TASK3_VMA
    88                                  EXTERN __TEXT_TASK4_VMA
    89                                  EXTERN __TASK_1_RODATA_PHY
    90                                  EXTERN __TASK_1_RODATA_VMA
    91                                  EXTERN __TASK_2_RODATA_PHY
    92                                  EXTERN __TASK_2_RODATA_VMA
    93                                  EXTERN __TASK_3_RODATA_PHY
    94                                  EXTERN __TASK_3_RODATA_VMA
    95                                  EXTERN __TASK_4_RODATA_PHY
    96                                  EXTERN __TASK_4_RODATA_VMA
    97                                  EXTERN __SYS_TABLES_PAG_T1_PHY
    98                                  EXTERN __SYS_TABLES_PAG_T2_PHY
    99                                  EXTERN __SYS_TABLES_PAG_T3_PHY
   100                                  EXTERN __SYS_TABLES_PAG_T4_PHY
   101                                  EXTERN __SYS_TABLES_PAG_T1_VMA
   102                                  EXTERN __SYS_TABLES_PAG_T2_VMA
   103                                  EXTERN __SYS_TABLES_PAG_T3_VMA
   104                                  EXTERN __SYS_TABLES_PAG_T4_VMA
   105                                  EXTERN __SYS_TABLES_PAG_T4_PHY
   106                                  EXTERN __TASK_2_BSS_PHY
   107                                  EXTERN __TASK_2_BSS_VMA
   108                                  EXTERN __TASK_3_BSS_PHY
   109                                  EXTERN __TASK_3_BSS_VMA
   110                                  EXTERN __TASK_4_BSS_VMA
   111                                  EXTERN __TASK_4_BSS_PHY
   112                                  EXTERN __STACK_TASK2_PHY
   113                                  EXTERN __STACK_TASK2_VMA
   114                                  EXTERN __STACK_TASK3_PHY
   115                                  EXTERN __STACK_TASK3_VMA
   116                                  EXTERN __STACK_TASK4_VMA
   117                                  EXTERN __STACK_TASK4_PHY
   118                                  EXTERN __TASK_2_DATA_PHY
   119                                  EXTERN __TASK_2_DATA_VMA
   120                                  EXTERN __TASK_3_DATA_PHY
   121                                  EXTERN __TASK_3_DATA_VMA
   122                                  EXTERN __TASK_4_DATA_VMA
   123                                  EXTERN __TASK_4_DATA_PHY
   124                                  EXTERN __STACK_TASK1_PHY
   125                                  EXTERN __STACK_TASK1_VMA
   126                                  EXTERN __FUNCTIONS_ROM_LMA
   127                                  
   128                                  
   129                                  
   130                                  
   131                                  PAG_PCD_YES equ 1       ; Cached                         
   132                                  PAG_PCD_NO  equ 0       ; No-cached
   133                                  PAG_PWT_YES equ 1       ; 1 to be write on Cache & Ram   
   134                                  PAG_PWT_NO  equ 0       ; 0 
   135                                  PAG_P_YES   equ 1       ; 1 Present
   136                                  PAG_P_NO    equ 0       ; 0 No presente
   137                                  PAG_RW_W    equ 1       ; 1 Read_Write
   138                                  PAG_RW_R    equ 0       ; 0 Read only
   139                                  PAG_US_SUP  equ 0       ; 0 Supervisor
   140                                  PAG_US_US   equ 1       ; 1 User  
   141                                  PAG_D       equ 0       ; Modify at page
   142                                  PAG_PAT     equ 0       ; PAT                   
   143                                  PAG_G_YES   equ 0       ; Global                 
   144                                  PAG_A       equ 0       ; Accesed
   145                                  PAG_PS_4K   equ 0       ; 4KB as PageSize
   146                                  _4k         EQU 0x400   ; 1024 or 0x400
   147                                  
   148                                  SUP_R_P EQU 0x01
   149                                  SUP_W_P EQU 0x03
   150                                  US_R_P  EQU 0x05
   151                                  US_W_P  EQU 0x07
   152                                  _1024 EQU 0x400
   153                                  
   154                                  go_paging:
   155                                  
   156                                  
   157                                  ;;;;;;;;;;;;;;;START - Paging;;;;;;;;;;;;;;;;;;;;;       
   158 00000000 FA                          cli
   159                                  
   160                                      ;; Clean all CR3 DTP & 1st page - 1024 + 1024
   161 00000001 BF[00000000]                mov edi,__CR3_KERNEL  
   162 00000006 B900280000                   mov ecx,_1024 *10      
   163 0000000B 31C0                        xor eax,eax           
   164 0000000D F3AB                        rep stosd   
   165                                  
   166 0000000F BF[00000000]                mov edi,__CR3_TASK1   
   167 00000014 B900080000                  mov ecx,_1024 *2      
   168 00000019 31C0                        xor eax,eax           
   169 0000001B F3AB                        rep stosd   
   170                                      
   171 0000001D BF[00000000]                mov edi,__CR3_TASK2   
   172 00000022 B900080000                  mov ecx,_1024 *2      
   173 00000027 31C0                        xor eax,eax           
   174 00000029 F3AB                        rep stosd   
   175                                  
   176 0000002B BF[00000000]                mov edi,__CR3_TASK3   
   177 00000030 B900080000                  mov ecx,_1024 *2      
   178 00000035 31C0                        xor eax,eax           
   179 00000037 F3AB                        rep stosd
   180                                  
   181                                      ; Set CR3 at DPT base add
   182 00000039 55                          push    ebp
   183 0000003A 89E5                        mov     ebp, esp
   184 0000003C 6A01                        push    PAG_PWT_YES
   185 0000003E 6A01                        push    PAG_PCD_YES
   186 00000040 68[00000000]                push    dword __PAGE_TABLES_VMA
   187 00000045 E8(00000000)                call    LOAD_CR3_ROM
   188 0000004A 0F22D8                      mov     cr3, eax
   189 0000004D C9                          leave    
   190                                  
   191                                      ;; After setting CR3x, go paging PT's.
   192 0000004E 55                          push    ebp
   193 0000004F 89E5                        mov     ebp, esp
   194 00000051 6A01                        push SUP_R_P 
   195 00000053 68[00000000]                push dword(__ISR_AND_KEYBOARD_PHY)
   196 00000058 68[00000000]                push dword(__ISR_AND_KEYBOARD_VMA)
   197 0000005D 68[00000000]                push dword(__CR3_KERNEL)  
   198 00000062 E8(00000000)                call set_dtp_pt_merged_rom
   199 00000067 C9                          leave
   200                                      ;;
   201 00000068 55                          push    ebp
   202 00000069 89E5                        mov     ebp, esp
   203 0000006B 6A01                        push SUP_R_P     
   204 0000006D 68[00000000]                push dword(__KERNEL_32_PHY)
   205 00000072 68[00000000]                push dword(__KERNEL_32_VMA)
   206 00000077 68[00000000]                push dword(__CR3_KERNEL)  
   207 0000007C E8(00000000)                call set_dtp_pt_merged_rom
   208 00000081 C9                          leave
   209                                      ;;
   210 00000082 55                          push    ebp
   211 00000083 89E5                        mov     ebp, esp
   212 00000085 6A01                        push SUP_R_P     
   213 00000087 68[00000000]                push dword(__FUNCTIONS_PHY)
   214 0000008C 68[00000000]                push dword(__FUNCTIONS_VMA)
   215 00000091 68[00000000]                push dword(__CR3_KERNEL)  
   216 00000096 E8(00000000)                call set_dtp_pt_merged_rom
   217 0000009B C9                          leave
   218                                      ;;
   219 0000009C 55                          push    ebp
   220 0000009D 89E5                        mov     ebp, esp
   221 0000009F 6A03                        push SUP_W_P     
   222 000000A1 68[00000000]                push dword(__SYS_TABLES_PHY)
   223 000000A6 68[00000000]                push dword(__SYS_TABLES_VMA)
   224 000000AB 68[00000000]                push dword(__CR3_KERNEL) 
   225 000000B0 E8(00000000)                call set_dtp_pt_merged_rom
   226 000000B5 C9                          leave
   227                                      ;;    
   228 000000B6 55                          push    ebp
   229 000000B7 89E5                        mov     ebp, esp
   230 000000B9 6A03                        push SUP_W_P     
   231 000000BB 68[00000000]                push dword(__SYS_TABLES_TSS_PHY)
   232 000000C0 68[00000000]                push dword(__SYS_TABLES_TSS_VMA)
   233 000000C5 68[00000000]                push dword(__CR3_KERNEL) 
   234 000000CA E8(00000000)                call set_dtp_pt_merged_rom
   235 000000CF C9                          leave 
   236                                      ;;
   237 000000D0 55                          push    ebp
   238 000000D1 89E5                        mov     ebp, esp
   239 000000D3 6A03                        push SUP_W_P     
   240 000000D5 68[00000000]                push dword(__SYS_TABLES_PAG_PHY)
   241 000000DA 68[00000000]                push dword(__SYS_TABLES_PAG_VMA)
   242 000000DF 68[00000000]                push dword(__CR3_KERNEL)  
   243 000000E4 E8(00000000)                call set_dtp_pt_merged_rom
   244 000000E9 C9                          leave 
   245                                      ;;    
   246 000000EA 55                          push    ebp
   247 000000EB 89E5                        mov     ebp, esp
   248 000000ED 6A03                        push SUP_W_P     
   249 000000EF 68[00000000]                push dword(__VIDEO_PHY)
   250 000000F4 68[00000000]                push dword(__VIDEO_VMA)
   251 000000F9 68[00000000]                push dword(__CR3_KERNEL)  
   252 000000FE E8(00000000)                call set_dtp_pt_merged_rom
   253 00000103 C9                          leave
   254                                      ;;   
   255 00000104 55                          push    ebp
   256 00000105 89E5                        mov     ebp, esp
   257 00000107 6A03                        push SUP_W_P     
   258 00000109 68[00000000]                push dword(__DATA_PHY)
   259 0000010E 68[00000000]                push dword(__DATA_VMA)
   260 00000113 68[00000000]                push dword(__CR3_KERNEL)  
   261 00000118 E8(00000000)                call set_dtp_pt_merged_rom
   262 0000011D C9                          leave 
   263                                      ;;
   264 0000011E 55                          push    ebp
   265 0000011F 89E5                        mov     ebp, esp
   266 00000121 6A03                        push SUP_W_P     
   267 00000123 68[00000000]                push dword(__STACK_START_32_PHY)
   268 00000128 68[00000000]                push dword(__STACK_START_32)
   269 0000012D 68[00000000]                push dword(__CR3_KERNEL)  
   270 00000132 E8(00000000)                call set_dtp_pt_merged_rom
   271 00000137 C9                          leave
   272                                      ;;
   273 00000138 55                          push    ebp
   274 00000139 89E5                        mov     ebp, esp
   275 0000013B 6A07                        push US_W_P     
   276 0000013D 68[00000000]                push dword(__STACK_TASK1_PHY)
   277 00000142 68[00000000]                push dword(__STACK_TASK1_VMA)
   278 00000147 68[00000000]                push dword(__CR3_KERNEL)  
   279 0000014C E8(00000000)                call set_dtp_pt_merged_rom
   280 00000151 C9                          leave
   281                                      ;;
   282 00000152 55                          push    ebp
   283 00000153 89E5                        mov     ebp, esp
   284 00000155 6A07                        push US_W_P     
   285 00000157 68[00000000]                push dword(__TABLE_KEYBOARD_PHY)
   286 0000015C 68[00000000]                push dword(__TABLE_KEYBOARD_VMA)
   287 00000161 68[00000000]                push dword(__CR3_KERNEL)  
   288 00000166 E8(00000000)                call set_dtp_pt_merged_rom
   289 0000016B C9                          leave
   290                                      ;;
   291 0000016C 55                          push    ebp
   292 0000016D 89E5                        mov     ebp, esp
   293 0000016F 6A03                        push SUP_W_P
   294 00000171 68[00000000]                push dword(__FUNCTIONS_ROM_LMA) ; Rom init
   295 00000176 68[00000000]                push dword(__FUNCTIONS_ROM_LMA)
   296 0000017B 68[00000000]                push dword(__CR3_KERNEL)          
   297 00000180 E8(00000000)                call set_dtp_pt_merged_rom
   298 00000185 C9                          leave
   299                                      ;;
   300                                      ; CHEQUEAR ESTO!!**
   301 00000186 55                          push    ebp
   302 00000187 89E5                        mov     ebp, esp
   303 00000189 6A03                        push SUP_W_P
   304 0000018B 68[00000000]                push dword(__INIT_32_VMA) ; Rom init
   305 00000190 68[00000000]                push dword(__INIT_32_VMA)
   306 00000195 68[00000000]                push dword(__CR3_KERNEL)          
   307 0000019A E8(00000000)                call set_dtp_pt_merged_rom
   308 0000019F C9                          leave
   309                                      ;;       TASK1
   310 000001A0 55                          push    ebp
   311 000001A1 89E5                        mov     ebp, esp                                            
   312 000001A3 6A01                        push SUP_R_P
   313 000001A5 68[00000000]                push dword(__ISR_AND_KEYBOARD_PHY)
   314 000001AA 68[00000000]                push dword(__ISR_AND_KEYBOARD_VMA)
   315 000001AF 68[00000000]                push dword(__CR3_TASK1)         
   316 000001B4 E8(00000000)                call set_dtp_pt_merged_rom
   317 000001B9 C9                          leave                       
   318                                      ;;
   319 000001BA 55                          push    ebp
   320 000001BB 89E5                        mov     ebp, esp                                     
   321 000001BD 6A05                        push US_R_P;SUP_R_P
   322 000001BF 68[00000000]                push dword(__FUNCTIONS_PHY)
   323 000001C4 68[00000000]                push dword(__FUNCTIONS_VMA)
   324 000001C9 68[00000000]                push dword(__CR3_TASK1)         
   325 000001CE E8(00000000)                call set_dtp_pt_merged_rom
   326 000001D3 C9                          leave                  
   327                                      ;;
   328 000001D4 55                          push    ebp
   329 000001D5 89E5                        mov     ebp, esp                    
   330 000001D7 6A03                        push SUP_W_P                        
   331 000001D9 68[00000000]                push dword(__SYS_TABLES_TSS_PHY)            
   332 000001DE 68[00000000]                push dword(__SYS_TABLES_TSS_VMA)            
   333 000001E3 68[00000000]                push dword(__CR3_TASK1)                       
   334 000001E8 E8(00000000)                call set_dtp_pt_merged_rom
   335 000001ED C9                          leave
   336                                      ;;
   337 000001EE 55                          push    ebp
   338 000001EF 89E5                        mov     ebp, esp                                          
   339 000001F1 6A07                        push US_W_P;SUP_W_P
   340 000001F3 68[00000000]                push dword(__VIDEO_PHY)
   341 000001F8 68[00000000]                push dword(__VIDEO_VMA)
   342 000001FD 68[00000000]                push dword(__CR3_TASK1)               
   343 00000202 E8(00000000)                call set_dtp_pt_merged_rom
   344 00000207 C9                          leave
   345                                      ;;
   346 00000208 55                          push    ebp
   347 00000209 89E5                        mov     ebp, esp                                          
   348 0000020B 6A03                        push SUP_W_P
   349 0000020D 68[00000000]                push dword(__DATA_PHY)
   350 00000212 68[00000000]                push dword(__DATA_VMA)
   351 00000217 68[00000000]                push dword(__CR3_TASK1)                           
   352 0000021C E8(00000000)                call set_dtp_pt_merged_rom
   353 00000221 C9                          leave
   354                                      ;;
   355 00000222 55                          push    ebp
   356 00000223 89E5                        mov     ebp, esp
   357 00000225 6A03                        push SUP_W_P
   358 00000227 68[00000000]                push dword(__STACK_START_32_PHY)
   359 0000022C 68[00000000]                push dword(__STACK_START_32)
   360 00000231 68[00000000]                push dword(__CR3_TASK1)           
   361 00000236 E8(00000000)                call set_dtp_pt_merged_rom
   362 0000023B C9                          leave
   363                                      ;;
   364 0000023C 55                          push    ebp
   365 0000023D 89E5                        mov     ebp, esp
   366 0000023F 6A01                        push SUP_R_P ;US_R_P
   367 00000241 68[00000000]                push dword(__TASK_1_TEXT_PHY)
   368 00000246 68[00000000]                push dword(__TASK_1_TEXT_VMA)
   369 0000024B 68[00000000]                push dword(__CR3_TASK1)           
   370 00000250 E8(00000000)                call set_dtp_pt_merged_rom
   371 00000255 C9                          leave
   372                                      ;;
   373 00000256 55                          push    ebp
   374 00000257 89E5                        mov     ebp, esp
   375 00000259 6A01                        push SUP_R_P;US_R_P
   376 0000025B 68[00000000]                push dword(__TASK_1_RODATA_PHY)
   377 00000260 68[00000000]                push dword(__TASK_1_RODATA_VMA)
   378 00000265 68[00000000]                push dword(__CR3_TASK1)           
   379 0000026A E8(00000000)                call set_dtp_pt_merged_rom
   380 0000026F C9                          leave
   381                                      ;;
   382 00000270 55                          push    ebp
   383 00000271 89E5                        mov     ebp, esp
   384 00000273 6A07                        push US_W_P                                            
   385 00000275 68[00000000]                push dword(__SYS_TABLES_PHY)
   386 0000027A 68[00000000]                push dword(__SYS_TABLES_VMA)                         
   387 0000027F 68[00000000]                push dword(__CR3_TASK1)                   
   388 00000284 E8(00000000)                call set_dtp_pt_merged_rom
   389 00000289 C9                          leave
   390                                      ;;   
   391 0000028A 55                          push    ebp
   392 0000028B 89E5                        mov     ebp, esp
   393 0000028D 6A07                        push US_W_P
   394 0000028F 68[00000000]                push dword(__SYS_TABLES_PAG_T1_PHY)
   395 00000294 68[00000000]                push dword(__SYS_TABLES_PAG_T1_VMA)
   396 00000299 68[00000000]                push dword(__CR3_TASK1)         
   397 0000029E E8(00000000)                call set_dtp_pt_merged_rom
   398 000002A3 C9                          leave
   399                                      ;;
   400 000002A4 55                          push    ebp
   401 000002A5 89E5                        mov     ebp, esp                               
   402 000002A7 6A07                        push US_W_P
   403 000002A9 68[00000000]                push dword(__TABLE_KEYBOARD_PHY)
   404 000002AE 68[00000000]                push dword(__TABLE_KEYBOARD_VMA)
   405 000002B3 68[00000000]                push dword(__CR3_TASK1)                    
   406 000002B8 E8(00000000)                call set_dtp_pt_merged_rom
   407 000002BD C9                          leave
   408                                      ;;
   409 000002BE 55                          push    ebp
   410 000002BF 89E5                        mov     ebp, esp
   411 000002C1 6A07                        push US_W_P
   412 000002C3 68[00000000]                push dword(__TASK_1_BSS_PHY)
   413 000002C8 68[00000000]                push dword(__TASK_1_BSS_VMA)
   414 000002CD 68[00000000]                push dword(__CR3_TASK1)           
   415 000002D2 E8(00000000)                call set_dtp_pt_merged_rom
   416 000002D7 C9                          leave
   417                                      ;;
   418 000002D8 55                          push    ebp
   419 000002D9 89E5                        mov     ebp, esp
   420 000002DB 6A07                        push US_W_P
   421 000002DD 68[00000000]                push dword(__TASK_1_DATA_PHY)
   422 000002E2 68[00000000]                push dword(__TASK_1_DATA_VMA)
   423 000002E7 68[00000000]                push dword(__CR3_TASK1)           
   424 000002EC E8(00000000)                call set_dtp_pt_merged_rom
   425 000002F1 C9                          leave
   426                                      ;;
   427 000002F2 55                          push    ebp
   428 000002F3 89E5                        mov     ebp, esp
   429 000002F5 6A07                        push US_W_P
   430 000002F7 68[00000000]                push dword(__STACK_TASK1_PHY)
   431 000002FC 68[00000000]                push dword(__STACK_TASK1_VMA)
   432 00000301 68[00000000]                push dword(__CR3_TASK1)           
   433 00000306 E8(00000000)                call set_dtp_pt_merged_rom
   434 0000030B C9                          leave
   435                                  
   436                                  
   437                                  ;------------------TASK 2-----------------
   438                                  
   439 0000030C 55                          push    ebp
   440 0000030D 89E5                        mov     ebp, esp
   441 0000030F 6A01                        push SUP_R_P                        
   442 00000311 68[00000000]                push dword(__SYS_TABLES_PHY)                 
   443 00000316 68[00000000]                push dword(__SYS_TABLES_VMA)              
   444 0000031B 68[00000000]                push dword(__CR3_TASK2)                   
   445 00000320 E8(00000000)                call set_dtp_pt_merged_rom
   446 00000325 C9                          leave
   447                                      ;;
   448 00000326 55                          push    ebp
   449 00000327 89E5                        mov     ebp, esp                                           
   450 00000329 6A01                        push SUP_R_P
   451 0000032B 68[00000000]                push dword(__ISR_AND_KEYBOARD_PHY)
   452 00000330 68[00000000]                push dword(__ISR_AND_KEYBOARD_VMA)
   453 00000335 68[00000000]                push dword(__CR3_TASK2)         
   454 0000033A E8(00000000)                call set_dtp_pt_merged_rom 
   455 0000033F C9                          leave                     
   456                                      ;;
   457 00000340 55                          push    ebp
   458 00000341 89E5                        mov     ebp, esp                                      
   459 00000343 6A05                        push US_R_P;SUP_R_P
   460 00000345 68[00000000]                push dword(__FUNCTIONS_PHY)
   461 0000034A 68[00000000]                push dword(__FUNCTIONS_VMA)
   462 0000034F 68[00000000]                push dword(__CR3_TASK2)         
   463 00000354 E8(00000000)                call set_dtp_pt_merged_rom
   464 00000359 C9                          leave                  
   465                                      ;;
   466 0000035A 55                          push    ebp
   467 0000035B 89E5                        mov     ebp, esp
   468 0000035D 6A03                        push SUP_W_P                                                   
   469 0000035F 68[00000000]                push dword(__SYS_TABLES_TSS_PHY)               
   470 00000364 68[00000000]                push dword(__SYS_TABLES_TSS_VMA)               
   471 00000369 68[00000000]                push dword(__CR3_TASK2)                       
   472 0000036E E8(00000000)                call set_dtp_pt_merged_rom
   473 00000373 C9                          leave
   474                                      ;;
   475 00000374 55                          push    ebp
   476 00000375 89E5                        mov     ebp, esp
   477 00000377 6A03                        push SUP_W_P
   478 00000379 68[00000000]                push dword(__SYS_TABLES_PAG_T2_PHY)
   479 0000037E 68[00000000]                push dword(__SYS_TABLES_PAG_T2_VMA)
   480 00000383 68[00000000]                push dword(__CR3_TASK2)         
   481 00000388 E8(00000000)                call set_dtp_pt_merged_rom
   482 0000038D C9                          leave
   483                                      ;;    
   484 0000038E 55                          push    ebp
   485 0000038F 89E5                        mov     ebp, esp                                
   486 00000391 6A07                        push US_W_P;SUP_W_P
   487 00000393 68[00000000]                push dword(__VIDEO_PHY)
   488 00000398 68[00000000]                push dword(__VIDEO_VMA)
   489 0000039D 68[00000000]                push dword(__CR3_TASK2)               
   490 000003A2 E8(00000000)                call set_dtp_pt_merged_rom
   491 000003A7 C9                          leave
   492                                      ;;
   493 000003A8 55                          push    ebp
   494 000003A9 89E5                        mov     ebp, esp                                          
   495 000003AB 6A03                        push SUP_W_P
   496 000003AD 68[00000000]                push dword(__DATA_PHY)
   497 000003B2 68[00000000]                push dword(__DATA_VMA)
   498 000003B7 68[00000000]                push dword(__CR3_TASK2)                           
   499 000003BC E8(00000000)                call set_dtp_pt_merged_rom
   500 000003C1 C9                          leave
   501                                  
   502                                  ;     push __STACK_KERNEL_T2_PHY
   503                                  ;     push __STACK_KERNEL_T2_VMA
   504                                  
   505 000003C2 55                          push    ebp
   506 000003C3 89E5                        mov     ebp, esp
   507 000003C5 6A03                        push SUP_W_P
   508 000003C7 68[00000000]                push dword(__STACK_START_32_PHY)
   509 000003CC 68[00000000]                push dword(__STACK_START_32)
   510 000003D1 68[00000000]                push dword(__CR3_TASK2)           
   511 000003D6 E8(00000000)                call set_dtp_pt_merged_rom
   512 000003DB C9                          leave
   513                                      ;;
   514 000003DC 55                          push    ebp
   515 000003DD 89E5                        mov     ebp, esp
   516 000003DF 6A01                        push SUP_R_P;US_R_P
   517 000003E1 68[00000000]                push dword(__TASK_2_TEXT_PHY)
   518 000003E6 68[00000000]                push dword(__TASK_2_TEXT_VMA)
   519 000003EB 68[00000000]                push dword(__CR3_TASK2)           
   520 000003F0 E8(00000000)                call set_dtp_pt_merged_rom
   521 000003F5 C9                          leave
   522                                      ;;
   523 000003F6 55                          push    ebp
   524 000003F7 89E5                        mov     ebp, esp
   525 000003F9 6A05                        push US_R_P
   526 000003FB 68[00000000]                push dword(__TASK_2_RODATA_PHY)
   527 00000400 68[00000000]                push dword(__TASK_2_RODATA_VMA)
   528 00000405 68[00000000]                push dword(__CR3_TASK2)           
   529 0000040A E8(00000000)                call set_dtp_pt_merged_rom
   530 0000040F C9                          leave
   531                                      ;;
   532 00000410 55                          push    ebp
   533 00000411 89E5                        mov     ebp, esp                              
   534 00000413 6A07                        push US_W_P
   535 00000415 68[00000000]                push dword(__TABLE_KEYBOARD_PHY)
   536 0000041A 68[00000000]                push dword(__TABLE_KEYBOARD_VMA)
   537 0000041F 68[00000000]                push dword(__CR3_TASK2)                    
   538 00000424 E8(00000000)                call set_dtp_pt_merged_rom
   539 00000429 C9                          leave
   540                                      ;;   
   541 0000042A 55                          push    ebp
   542 0000042B 89E5                        mov     ebp, esp 
   543 0000042D 6A07                        push US_W_P
   544 0000042F 68[00000000]                push dword(__TASK_2_BSS_PHY)
   545 00000434 68[00000000]                push dword(__TASK_2_BSS_VMA)
   546 00000439 68[00000000]                push dword(__CR3_TASK2)            
   547 0000043E E8(00000000)                call set_dtp_pt_merged_rom
   548 00000443 C9                          leave
   549                                      ;;
   550 00000444 55                          push    ebp
   551 00000445 89E5                        mov     ebp, esp 
   552 00000447 6A07                        push US_W_P
   553 00000449 68[00000000]                push dword(__TASK_2_DATA_PHY)
   554 0000044E 68[00000000]                push dword(__TASK_2_DATA_VMA)
   555 00000453 68[00000000]                push dword(__CR3_TASK2)           
   556 00000458 E8(00000000)                call set_dtp_pt_merged_rom
   557 0000045D C9                          leave 
   558                                      ;;
   559 0000045E 55                          push    ebp
   560 0000045F 89E5                        mov     ebp, esp 
   561 00000461 6A07                        push US_W_P  
   562 00000463 68[00000000]                push dword(__STACK_TASK2_PHY)
   563 00000468 68[00000000]                push dword(__STACK_TASK2_VMA)
   564 0000046D 68[00000000]                push dword(__CR3_TASK2)            
   565 00000472 E8(00000000)                call set_dtp_pt_merged_rom
   566 00000477 C9                          leave    
   567                                  
   568                                  ;------------------TASK 3-----------------
   569                                  
   570 00000478 55                          push    ebp
   571 00000479 89E5                        mov     ebp, esp 
   572 0000047B 6A01                        push SUP_R_P                                      
   573 0000047D 68[00000000]                push dword(__SYS_TABLES_PHY)                
   574 00000482 68[00000000]                push dword(__SYS_TABLES_VMA )                 
   575 00000487 68[00000000]                push dword(__CR3_TASK3)                   
   576 0000048C E8(00000000)                call set_dtp_pt_merged_rom
   577 00000491 C9                          leave
   578                                      ;;
   579 00000492 55                          push    ebp
   580 00000493 89E5                        mov     ebp, esp                                           
   581 00000495 6A07                        push US_W_P;SUP_R_P
   582 00000497 68[00000000]                push dword(__VIDEO_PHY)
   583 0000049C 68[00000000]                push dword(__VIDEO_VMA)
   584 000004A1 68[00000000]                push dword(__CR3_TASK3)               
   585 000004A6 E8(00000000)                call set_dtp_pt_merged_rom
   586 000004AB C9                          leave
   587                                      ;;
   588 000004AC 55                          push    ebp
   589 000004AD 89E5                        mov     ebp, esp                                            
   590 000004AF 6A01                        push SUP_R_P
   591 000004B1 68[00000000]                push dword(__ISR_AND_KEYBOARD_PHY)
   592 000004B6 68[00000000]                push dword(__ISR_AND_KEYBOARD_VMA)
   593 000004BB 68[00000000]                push dword(__CR3_TASK3)         
   594 000004C0 E8(00000000)                call set_dtp_pt_merged_rom                       
   595 000004C5 C9                          leave
   596                                      ;;
   597 000004C6 55                          push    ebp
   598 000004C7 89E5                        mov     ebp, esp                                       
   599 000004C9 6A05                        push US_R_P;SUP_R_P
   600 000004CB 68[00000000]                push dword(__FUNCTIONS_PHY)
   601 000004D0 68[00000000]                push dword(__FUNCTIONS_VMA)
   602 000004D5 68[00000000]                push dword(__CR3_TASK3)         
   603 000004DA E8(00000000)                call set_dtp_pt_merged_rom                   
   604 000004DF C9                          leave
   605                                      ;;
   606 000004E0 55                          push    ebp
   607 000004E1 89E5                        mov     ebp, esp 
   608 000004E3 6A03                        push SUP_W_P                                            
   609 000004E5 68[00000000]                push dword(__SYS_TABLES_TSS_PHY)               
   610 000004EA 68[00000000]                push dword(__SYS_TABLES_TSS_VMA)              
   611 000004EF 68[00000000]                push dword(__CR3_TASK3)                       
   612 000004F4 E8(00000000)                call set_dtp_pt_merged_rom
   613 000004F9 C9                          leave
   614                                      ;;
   615 000004FA 55                          push    ebp
   616 000004FB 89E5                        mov     ebp, esp 
   617 000004FD 6A03                        push SUP_W_P
   618 000004FF 68[00000000]                push dword(__SYS_TABLES_PAG_T3_PHY)
   619 00000504 68[00000000]                push dword(__SYS_TABLES_PAG_T3_VMA)
   620 00000509 68[00000000]                push dword(__CR3_TASK3)         
   621 0000050E E8(00000000)                call set_dtp_pt_merged_rom
   622 00000513 C9                          leave
   623                                      ;;
   624 00000514 55                          push    ebp
   625 00000515 89E5                        mov     ebp, esp                                           
   626 00000517 6A03                        push SUP_W_P
   627 00000519 68[00000000]                push dword(__DATA_PHY)
   628 0000051E 68[00000000]                push dword(__DATA_VMA)
   629 00000523 68[00000000]                push dword(__CR3_TASK3)                           
   630 00000528 E8(00000000)                call set_dtp_pt_merged_rom
   631 0000052D C9                          leave
   632                                  ;     push __STACK_KERNEL_T3_PHY
   633                                  ;     push __STACK_KERNEL_T3_VMA
   634 0000052E 55                          push    ebp
   635 0000052F 89E5                        mov     ebp, esp 
   636 00000531 6A03                        push SUP_W_P
   637 00000533 68[00000000]                push dword(__STACK_START_32_PHY)
   638 00000538 68[00000000]                push dword(__STACK_START_32)
   639 0000053D 68[00000000]                push dword(__CR3_TASK3)           
   640 00000542 E8(00000000)                call set_dtp_pt_merged_rom
   641 00000547 C9                          leave
   642                                      ;;
   643 00000548 55                          push    ebp
   644 00000549 89E5                        mov     ebp, esp 
   645 0000054B 6A01                        push SUP_R_P;US_R_P
   646 0000054D 68[00000000]                push dword(__TASK_3_TEXT_PHY)
   647 00000552 68[00000000]                push dword(__TASK_3_TEXT_VMA)
   648 00000557 68[00000000]                push dword(__CR3_TASK3)           
   649 0000055C E8(00000000)                call set_dtp_pt_merged_rom
   650 00000561 C9                          leave
   651                                      ;;
   652 00000562 55                          push    ebp
   653 00000563 89E5                        mov     ebp, esp 
   654 00000565 6A05                        push US_R_P
   655 00000567 68[00000000]                push dword(__TASK_3_RODATA_PHY)
   656 0000056C 68[00000000]                push dword(__TASK_3_RODATA_VMA)
   657 00000571 68[00000000]                push dword(__CR3_TASK3)           
   658 00000576 E8(00000000)                call set_dtp_pt_merged_rom
   659 0000057B C9                          leave
   660                                      ;;
   661 0000057C 55                          push    ebp
   662 0000057D 89E5                        mov     ebp, esp                                
   663 0000057F 6A07                        push US_W_P
   664 00000581 68[00000000]                push dword(__TABLE_KEYBOARD_PHY)
   665 00000586 68[00000000]                push dword(__TABLE_KEYBOARD_VMA)
   666 0000058B 68[00000000]                push dword(__CR3_TASK3)                    
   667 00000590 E8(00000000)                call set_dtp_pt_merged_rom
   668 00000595 C9                          leave
   669                                      ;;
   670 00000596 55                          push    ebp
   671 00000597 89E5                        mov     ebp, esp 
   672 00000599 6A07                        push US_W_P
   673 0000059B 68[00000000]                push dword( __TASK_3_BSS_PHY)
   674 000005A0 68[00000000]                push dword(__TASK_3_BSS_VMA)
   675 000005A5 68[00000000]                push dword(__CR3_TASK3)           
   676 000005AA E8(00000000)                call set_dtp_pt_merged_rom
   677 000005AF C9                          leave
   678                                      ;;
   679 000005B0 55                          push    ebp
   680 000005B1 89E5                        mov     ebp, esp 
   681 000005B3 6A07                        push US_W_P
   682 000005B5 68[00000000]                push dword(__TASK_3_DATA_PHY)
   683 000005BA 68[00000000]                push dword(__TASK_3_DATA_VMA)
   684 000005BF 68[00000000]                push dword(__CR3_TASK3)           
   685 000005C4 E8(00000000)                call set_dtp_pt_merged_rom
   686 000005C9 C9                          leave
   687                                      ;;
   688 000005CA 55                          push    ebp
   689 000005CB 89E5                        mov     ebp, esp 
   690 000005CD 6A07                        push US_W_P  
   691 000005CF 68[00000000]                push dword(__STACK_TASK3_PHY)
   692 000005D4 68[00000000]                push dword(__STACK_TASK3_VMA)
   693 000005D9 68[00000000]                push dword(__CR3_TASK3)           
   694 000005DE E8(00000000)                call set_dtp_pt_merged_rom
   695 000005E3 C9                          leave
   696                                  
   697                                  
   698                                  ;------------------TASK 4-----------------
   699                                  
   700 000005E4 55                          push    ebp
   701 000005E5 89E5                        mov     ebp, esp 
   702 000005E7 6A01                        push SUP_R_P                                      
   703 000005E9 68[00000000]                push dword(__SYS_TABLES_PHY)                
   704 000005EE 68[00000000]                push dword(__SYS_TABLES_VMA )                 
   705 000005F3 68[00000000]                push dword(__CR3_TASK4)                   
   706 000005F8 E8(00000000)                call set_dtp_pt_merged_rom
   707 000005FD C9                          leave
   708                                      ;;
   709 000005FE 55                          push    ebp
   710 000005FF 89E5                        mov     ebp, esp                                           
   711 00000601 6A07                        push US_W_P;SUP_R_P
   712 00000603 68[00000000]                push dword(__VIDEO_PHY)
   713 00000608 68[00000000]                push dword(__VIDEO_VMA)
   714 0000060D 68[00000000]                push dword(__CR3_TASK4)               
   715 00000612 E8(00000000)                call set_dtp_pt_merged_rom
   716 00000617 C9                          leave
   717                                      ;;
   718 00000618 55                          push    ebp
   719 00000619 89E5                        mov     ebp, esp                                            
   720 0000061B 6A01                        push SUP_R_P
   721 0000061D 68[00000000]                push dword(__ISR_AND_KEYBOARD_PHY)
   722 00000622 68[00000000]                push dword(__ISR_AND_KEYBOARD_VMA)
   723 00000627 68[00000000]                push dword(__CR3_TASK4)         
   724 0000062C E8(00000000)                call set_dtp_pt_merged_rom                       
   725 00000631 C9                          leave
   726                                      ;;
   727 00000632 55                          push    ebp
   728 00000633 89E5                        mov     ebp, esp                                       
   729 00000635 6A05                        push US_R_P;SUP_R_P
   730 00000637 68[00000000]                push dword(__FUNCTIONS_PHY)
   731 0000063C 68[00000000]                push dword(__FUNCTIONS_VMA)
   732 00000641 68[00000000]                push dword(__CR3_TASK4)         
   733 00000646 E8(00000000)                call set_dtp_pt_merged_rom                   
   734 0000064B C9                          leave
   735                                      ;;
   736 0000064C 55                          push    ebp
   737 0000064D 89E5                        mov     ebp, esp 
   738 0000064F 6A03                        push SUP_W_P                                            
   739 00000651 68[00000000]                push dword(__SYS_TABLES_TSS_PHY)               
   740 00000656 68[00000000]                push dword(__SYS_TABLES_TSS_VMA)              
   741 0000065B 68[00000000]                push dword(__CR3_TASK4)                       
   742 00000660 E8(00000000)                call set_dtp_pt_merged_rom
   743 00000665 C9                          leave
   744                                      ;;
   745 00000666 55                          push    ebp
   746 00000667 89E5                        mov     ebp, esp 
   747 00000669 6A03                        push SUP_W_P
   748 0000066B 68[00000000]                push dword(__SYS_TABLES_PAG_T4_PHY)
   749 00000670 68[00000000]                push dword(__SYS_TABLES_PAG_T4_VMA)
   750 00000675 68[00000000]                push dword(__CR3_TASK4)         
   751 0000067A E8(00000000)                call set_dtp_pt_merged_rom
   752 0000067F C9                          leave
   753                                      ;;
   754 00000680 55                          push    ebp
   755 00000681 89E5                        mov     ebp, esp                                           
   756 00000683 6A03                        push SUP_W_P
   757 00000685 68[00000000]                push dword(__DATA_PHY)
   758 0000068A 68[00000000]                push dword(__DATA_VMA)
   759 0000068F 68[00000000]                push dword(__CR3_TASK4)                           
   760 00000694 E8(00000000)                call set_dtp_pt_merged_rom
   761 00000699 C9                          leave
   762                                  ;     push __STACK_KERNEL_T3_PHY
   763                                  ;     push __STACK_KERNEL_T3_VMA
   764 0000069A 55                          push    ebp
   765 0000069B 89E5                        mov     ebp, esp 
   766 0000069D 6A03                        push SUP_W_P
   767 0000069F 68[00000000]                push dword(__STACK_START_32_PHY)
   768 000006A4 68[00000000]                push dword(__STACK_START_32)
   769 000006A9 68[00000000]                push dword(__CR3_TASK4)           
   770 000006AE E8(00000000)                call set_dtp_pt_merged_rom
   771 000006B3 C9                          leave
   772                                      ;;
   773 000006B4 55                          push    ebp
   774 000006B5 89E5                        mov     ebp, esp 
   775 000006B7 6A01                        push SUP_R_P ; US_R_P
   776 000006B9 68[00000000]                push dword(__TASK_4_TEXT_PHY)
   777 000006BE 68[00000000]                push dword(__TASK_4_TEXT_VMA)
   778 000006C3 68[00000000]                push dword(__CR3_TASK4)           
   779 000006C8 E8(00000000)                call set_dtp_pt_merged_rom
   780 000006CD C9                          leave
   781                                      ;;
   782 000006CE 55                          push    ebp
   783 000006CF 89E5                        mov     ebp, esp 
   784 000006D1 6A05                        push US_R_P
   785 000006D3 68[00000000]                push dword(__TASK_4_RODATA_PHY)
   786 000006D8 68[00000000]                push dword(__TASK_4_RODATA_VMA)
   787 000006DD 68[00000000]                push dword(__CR3_TASK4)           
   788 000006E2 E8(00000000)                call set_dtp_pt_merged_rom
   789 000006E7 C9                          leave
   790                                      ;;
   791 000006E8 55                          push    ebp
   792 000006E9 89E5                        mov     ebp, esp                                
   793 000006EB 6A07                        push US_W_P
   794 000006ED 68[00000000]                push dword(__TABLE_KEYBOARD_PHY)
   795 000006F2 68[00000000]                push dword(__TABLE_KEYBOARD_VMA)
   796 000006F7 68[00000000]                push dword(__CR3_TASK4)                    
   797 000006FC E8(00000000)                call set_dtp_pt_merged_rom
   798 00000701 C9                          leave
   799                                      ;;
   800 00000702 55                          push    ebp
   801 00000703 89E5                        mov     ebp, esp 
   802 00000705 6A07                        push US_W_P
   803 00000707 68[00000000]                push dword( __TASK_4_BSS_PHY)
   804 0000070C 68[00000000]                push dword(__TASK_4_BSS_VMA)
   805 00000711 68[00000000]                push dword(__CR3_TASK4)           
   806 00000716 E8(00000000)                call set_dtp_pt_merged_rom
   807 0000071B C9                          leave
   808                                      ;;
   809 0000071C 55                          push    ebp
   810 0000071D 89E5                        mov     ebp, esp 
   811 0000071F 6A07                        push US_W_P
   812 00000721 68[00000000]                push dword(__TASK_4_DATA_PHY)
   813 00000726 68[00000000]                push dword(__TASK_4_DATA_VMA)
   814 0000072B 68[00000000]                push dword(__CR3_TASK4)           
   815 00000730 E8(00000000)                call set_dtp_pt_merged_rom
   816 00000735 C9                          leave
   817                                      ;;
   818 00000736 55                          push    ebp
   819 00000737 89E5                        mov     ebp, esp 
   820 00000739 6A03                        push SUP_W_P ;US_W_P  
   821 0000073B 68[00000000]                push dword(__STACK_TASK4_PHY)
   822 00000740 68[00000000]                push dword(__STACK_TASK4_VMA)
   823 00000745 68[00000000]                push dword(__CR3_TASK4)           
   824 0000074A E8(00000000)                call set_dtp_pt_merged_rom
   825 0000074F C9                          leave
   826                                  
   827                                  
   828                                      ;; Ready to turn on paging, say touching CR registers, go on
   829                                      
   830 00000750 E9(00000000)                jmp turn_on_paging ; Return ready to turn on paging
