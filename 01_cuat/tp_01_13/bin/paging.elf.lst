     1                                  %include "inc/processor-flags.h" 
     1                              <1> %define X86_CR0_PE      0x00000001 ;/* Protectede mode enable*/
     2                              <1> %define X86_CR0_MP      0x00000002 ;/* Monitor coProcessor*/
     3                              <1> %define X86_CR0_EM      0x00000004 ;/* Emulation*/
     4                              <1> %define X86_CR0_TS      0x00000008 ;/* Task Switched*/
     5                              <1> %define X86_CR0_ET      0x00000010 ;/* Extension Type*/
     6                              <1> %define X86_CR0_NE      0x00000020 ;/* Numeric Error*/
     7                              <1> %define X86_CR0_WP      0x00010000 ;/* Write Protect*/
     8                              <1> %define X86_CR0_AM      0x00040000 ;/* Alignment Mask*/
     9                              <1> %define X86_CR0_NW      0x20000000 ;/* Not Write-through*/
    10                              <1> %define X86_CR0_CD      0x40000000 ;/* Cache Disable*/
    11                              <1> %define X86_CR0_PG      0x80000000 ;/* PaGine*/
    12                              <1> 
    13                              <1> %define IDLE            0x00000000;
    14                              <1> %define WAITING         0x00000001;
    15                              <1> %define RUNNING         0x00000002;
     2                                  %include "inc/defines.h" 
     1                              <1> 
     2                              <1> %define PORT_A_8042    0x60
     3                              <1> %define CTRL_PORT_8042 0x64
     4                              <1> %define KEYB_DIS       0xAD
     5                              <1> %define KEYB_EN        0xAE
     6                              <1> %define READ_OUT_8042  0xD0
     7                              <1> %define WRITE_OUT_8042 0xD1
     8                              <1> 
     9                              <1> 
    10                              <1> %define _KEY_1     0x02
    11                              <1> %define _KEY_2     0x03
    12                              <1> %define _KEY_3     0x04
    13                              <1> %define _KEY_4     0x05
    14                              <1> %define _KEY_5     0x06
    15                              <1> %define _KEY_6     0x07
    16                              <1> %define _KEY_7     0x08
    17                              <1> %define _KEY_8     0x09
    18                              <1> %define _KEY_9     0x0A
    19                              <1> %define _KEY_0     0x0B
    20                              <1> 
    21                              <1> %define _KEY_ENTER 0x1C
    22                              <1> 
    23                              <1> %define _KEY_A     0x1E
    24                              <1> %define _KEY_B     0x30
    25                              <1> %define _KEY_C     0x2E
    26                              <1> %define _KEY_D     0x20
    27                              <1> %define _KEY_E     0x12
    28                              <1> %define _KEY_F     0x21
    29                              <1> %define _KEY_G     0x22
    30                              <1> %define _KEY_H     0x23
    31                              <1> %define _KEY_I     0x17
    32                              <1> %define _KEY_J     0x24
    33                              <1> %define _KEY_K     0x25
    34                              <1> %define _KEY_L     0x26
    35                              <1> %define _KEY_M     0x32
    36                              <1> %define _KEY_N     0x31
    37                              <1> %define _KEY_O     0x18
    38                              <1> %define _KEY_P     0x19
    39                              <1> %define _KEY_Q     0x10
    40                              <1> %define _KEY_R     0x13
    41                              <1> %define _KEY_S     0x1F
    42                              <1> %define _KEY_T     0x14
    43                              <1> %define _KEY_U     0x16
    44                              <1> %define _KEY_V     0x2F
    45                              <1> %define _KEY_W     0x11
    46                              <1> %define _KEY_X     0x2D
    47                              <1> %define _KEY_Y     0x15
    48                              <1> %define _KEY_Z     0x2C
    49                              <1> 
    50                              <1> SYS_CALL_HALT     EQU     0
    51                              <1> SYS_CALL_READ     EQU     1
    52                              <1> SYS_CALL_WRITE    EQU     2
    53                              <1> SYS_CALL_SCREEN   EQU     3
    54                              <1> 
    55                              <1>  
     3                                  section .go_paging
     4                                  
     5                                  GLOBAL go_paging    
     6                                  EXTERN __SYS_TABLES_PHY      
     7                                  EXTERN __PAGE_TABLES_PHY     
     8                                  EXTERN __FUNCTIONS_PHY       
     9                                  EXTERN __VIDEO_PHY           
    10                                  EXTERN __ISR_AND_KEYBOARD_PHY
    11                                  EXTERN __DATA_PHY            
    12                                  EXTERN __TABLE_KEYBOARD_PHY  
    13                                  EXTERN __KERNEL_32_PHY       
    14                                  EXTERN __TASK_1_TEXT_PHY     
    15                                  EXTERN __TASK_1_BSS_PHY      
    16                                  EXTERN __TASK_1_DATA_PHY     
    17                                  EXTERN __TASK_1_RODATA_PHY   
    18                                  EXTERN __STACK_START_32_PHY  
    19                                  EXTERN __STACK_END_32_PHY    
    20                                  EXTERN __STACK_TASK1_PHY
    21                                  EXTERN __STACK_TASK1_VMA
    22                                  EXTERN __STACK_TASK2_VMA
    23                                  EXTERN __STACK_TASK3_VMA
    24                                  EXTERN __TASK_1_STACK_END_PHY
    25                                  EXTERN __SYS_TABLES_IDT
    26                                  EXTERN __PAGE_TABLES_VMA
    27                                  EXTERN __VIDEO_VMA
    28                                  EXTERN __load_DTP_entry_rom
    29                                  EXTERN __load_TP_entry_rom
    30                                  EXTERN __DATA_VMA
    31                                  EXTERN __INIT_16_VMA
    32                                  EXTERN __INIT_32_VMA
    33                                  EXTERN __STACK_START_32_VMA
    34                                  EXTERN __FUNCTIONS_VMA
    35                                  EXTERN __SYS_TABLES_VMA
    36                                  EXTERN __DATA_VMA
    37                                  EXTERN __ISR_AND_KEYBOARD_VMA
    38                                  EXTERN __KERNEL_32_VMA
    39                                  EXTERN __TASK_1_BSS_VMA
    40                                  EXTERN __TASK_1_RODATA_VMA
    41                                  EXTERN __TASK_1_TEXT_VMA
    42                                  EXTERN __TASK_1_DATA_VMA
    43                                  EXTERN __TABLE_KEYBOARD_VMA
    44                                  EXTERN __TASK_1_RODATA_PHY
    45                                  EXTERN __STACK_TASK1_VMA
    46                                  EXTERN __STACK_START_32
    47                                  EXTERN __CR3_KERNEL
    48                                  EXTERN __CR3_TASK1
    49                                  EXTERN __CR3_TASK2
    50                                  EXTERN __CR3_TASK3
    51                                  EXTERN __CR3_TASK4
    52                                  EXTERN LOAD_CR3_ROM
    53                                  EXTERN set_dtp_pt_merged_rom
    54                                  EXTERN __SYS_TABLES_TSS_PHY
    55                                  EXTERN __SYS_TABLES_PAG_PHY
    56                                  EXTERN __SYS_TABLES_PAG_VMA
    57                                  EXTERN __SYS_TABLES_LMA
    58                                  EXTERN TURN_ON_PAGING
    59                                  EXTERN __INIT_32_LMA
    60                                  EXTERN __TASK_3_RODATA_PHY
    61                                  EXTERN __TASK_3_RODATA_VMA
    62                                  EXTERN __TASK_2_TEXT_PHY
    63                                  EXTERN __TASK_2_TEXT_VMA
    64                                  EXTERN __TASK_3_TEXT_PHY
    65                                  EXTERN __TASK_3_TEXT_VMA
    66                                  EXTERN __SYS_TABLES_TSS_VMA
    67                                  EXTERN __STACK_START_32_PHY
    68                                  EXTERN __STACK_START_32
    69                                  EXTERN __STACK_TASK1_PHY
    70                                  EXTERN __STACK_TASK1_VMA
    71                                  EXTERN __SYS_TABLES_TSS_VMA
    72                                  EXTERN __STACK_KERNEL_T1_PHY
    73                                  EXTERN __STACK_KERNEL_T1_VMA
    74                                  EXTERN __TASK_1_TEXT_PHY
    75                                  EXTERN __TASK_2_TEXT_PHY
    76                                  EXTERN __TASK_3_TEXT_PHY
    77                                  EXTERN __TASK_4_TEXT_PHY
    78                                  EXTERN __TASK_1_TEXT_VMA
    79                                  EXTERN __TASK_2_TEXT_VMA
    80                                  EXTERN __TASK_3_TEXT_VMA
    81                                  EXTERN __TASK_4_TEXT_VMA
    82                                  EXTERN __TEXT_TASK2_PHY
    83                                  EXTERN __TEXT_TASK3_PHY
    84                                  EXTERN __TEXT_TASK4_PHY
    85                                  EXTERN __TEXT_TASK1_VMA
    86                                  EXTERN __TEXT_TASK2_VMA
    87                                  EXTERN __TEXT_TASK3_VMA
    88                                  EXTERN __TEXT_TASK4_VMA
    89                                  EXTERN __TASK_1_RODATA_PHY
    90                                  EXTERN __TASK_1_RODATA_VMA
    91                                  EXTERN __TASK_2_RODATA_PHY
    92                                  EXTERN __TASK_2_RODATA_VMA
    93                                  EXTERN __TASK_3_RODATA_PHY
    94                                  EXTERN __TASK_3_RODATA_VMA
    95                                  EXTERN __TASK_4_RODATA_PHY
    96                                  EXTERN __TASK_4_RODATA_VMA
    97                                  EXTERN __SYS_TABLES_PAG_T1_PHY
    98                                  EXTERN __SYS_TABLES_PAG_T2_PHY
    99                                  EXTERN __SYS_TABLES_PAG_T3_PHY
   100                                  EXTERN __SYS_TABLES_PAG_T4_PHY
   101                                  EXTERN __SYS_TABLES_PAG_T1_VMA
   102                                  EXTERN __SYS_TABLES_PAG_T2_VMA
   103                                  EXTERN __SYS_TABLES_PAG_T3_VMA
   104                                  EXTERN __SYS_TABLES_PAG_T4_VMA
   105                                  EXTERN __SYS_TABLES_PAG_T4_PHY
   106                                  EXTERN __TASK_2_BSS_PHY
   107                                  EXTERN __TASK_2_BSS_VMA
   108                                  EXTERN __TASK_3_BSS_PHY
   109                                  EXTERN __TASK_3_BSS_VMA
   110                                  EXTERN __TASK_4_BSS_VMA
   111                                  EXTERN __TASK_4_BSS_PHY
   112                                  EXTERN __STACK_TASK2_PHY
   113                                  EXTERN __STACK_TASK2_VMA
   114                                  EXTERN __STACK_TASK3_PHY
   115                                  EXTERN __STACK_TASK3_VMA
   116                                  EXTERN __STACK_TASK4_VMA
   117                                  EXTERN __STACK_TASK4_PHY
   118                                  EXTERN __TASK_2_DATA_PHY
   119                                  EXTERN __TASK_2_DATA_VMA
   120                                  EXTERN __TASK_3_DATA_PHY
   121                                  EXTERN __TASK_3_DATA_VMA
   122                                  EXTERN __TASK_4_DATA_VMA
   123                                  EXTERN __TASK_4_DATA_PHY
   124                                  EXTERN __STACK_TASK1_PHY
   125                                  EXTERN __STACK_TASK1_VMA
   126                                  EXTERN __FUNCTIONS_ROM_LMA
   127                                  EXTERN __STACK_KERNEL_T1_VMA
   128                                  EXTERN __STACK_KERNEL_T1_VMA
   129                                  EXTERN __STACK_KERNEL_T2_VMA
   130                                  EXTERN __STACK_KERNEL_T2_PHY
   131                                  EXTERN __STACK_KERNEL_T3_VMA
   132                                  EXTERN __STACK_KERNEL_T3_PHY
   133                                  EXTERN __STACK_KERNEL_T4_VMA
   134                                  EXTERN __STACK_KERNEL_T4_PHY
   135                                  EXTERN DS_SEL_11
   136                                  EXTERN CS_SEL_11
   137                                  
   138                                  
   139                                  
   140                                  
   141                                  PAG_PCD_YES equ 1       ; Cached                         
   142                                  PAG_PCD_NO  equ 0       ; No-cached
   143                                  PAG_PWT_YES equ 1       ; 1 to be write on Cache & Ram   
   144                                  PAG_PWT_NO  equ 0       ; 0 
   145                                  PAG_P_YES   equ 1       ; 1 Present
   146                                  PAG_P_NO    equ 0       ; 0 No presente
   147                                  PAG_RW_W    equ 1       ; 1 Read_Write
   148                                  PAG_RW_R    equ 0       ; 0 Read only
   149                                  PAG_US_SUP  equ 0       ; 0 Supervisor
   150                                  PAG_US_US   equ 1       ; 1 User  
   151                                  PAG_D       equ 0       ; Modify at page
   152                                  PAG_PAT     equ 0       ; PAT                   
   153                                  PAG_G_YES   equ 0       ; Global                 
   154                                  PAG_A       equ 0       ; Accesed
   155                                  PAG_PS_4K   equ 0       ; 4KB as PageSize
   156                                  _4k         EQU 0x400   ; 1024 or 0x400
   157                                  
   158                                  SUP_R_P EQU 0x01
   159                                  SUP_W_P EQU 0x03
   160                                  US_R_P  EQU 0x05
   161                                  US_W_P  EQU 0x07
   162                                  _1024 EQU 0x400
   163                                  
   164                                  go_paging:
   165                                  
   166                                  
   167                                  ;;;;;;;;;;;;;;;START - Paging;;;;;;;;;;;;;;;;;;;;;       
   168 00000000 FA                          cli
   169                                  
   170                                      ;; Clean all CR3 DTP & 1st page - 1024 + 1024
   171 00000001 BF[00000000]                mov edi,__CR3_KERNEL  
   172 00000006 B900280000                   mov ecx,_1024 *10      
   173 0000000B 31C0                        xor eax,eax           
   174 0000000D F3AB                        rep stosd   
   175                                  
   176 0000000F BF[00000000]                mov edi,__CR3_TASK1   
   177 00000014 B900080000                  mov ecx,_1024 *2      
   178 00000019 31C0                        xor eax,eax           
   179 0000001B F3AB                        rep stosd   
   180                                      
   181 0000001D BF[00000000]                mov edi,__CR3_TASK2   
   182 00000022 B900080000                  mov ecx,_1024 *2      
   183 00000027 31C0                        xor eax,eax           
   184 00000029 F3AB                        rep stosd   
   185                                  
   186 0000002B BF[00000000]                mov edi,__CR3_TASK3   
   187 00000030 B900080000                  mov ecx,_1024 *2      
   188 00000035 31C0                        xor eax,eax           
   189 00000037 F3AB                        rep stosd
   190                                  
   191                                      ; Set CR3 at DPT base add
   192 00000039 55                          push    ebp
   193 0000003A 89E5                        mov     ebp, esp
   194 0000003C 6A01                        push    PAG_PWT_YES
   195 0000003E 6A01                        push    PAG_PCD_YES
   196 00000040 68[00000000]                push    dword __PAGE_TABLES_VMA
   197 00000045 E8(00000000)                call    LOAD_CR3_ROM
   198 0000004A 0F22D8                      mov     cr3, eax
   199 0000004D C9                          leave    
   200                                  
   201                                      ;; After setting CR3x, go paging PT's.
   202 0000004E 55                          push    ebp
   203 0000004F 89E5                        mov     ebp, esp
   204 00000051 6A01                        push SUP_R_P 
   205 00000053 68[00000000]                push dword(__ISR_AND_KEYBOARD_PHY)
   206 00000058 68[00000000]                push dword(__ISR_AND_KEYBOARD_VMA)
   207 0000005D 68[00000000]                push dword(__CR3_KERNEL)  
   208 00000062 E8(00000000)                call set_dtp_pt_merged_rom
   209 00000067 C9                          leave
   210                                      ;;
   211 00000068 55                          push    ebp
   212 00000069 89E5                        mov     ebp, esp
   213 0000006B 6A01                        push SUP_R_P     
   214 0000006D 68[00000000]                push dword(__KERNEL_32_PHY)
   215 00000072 68[00000000]                push dword(__KERNEL_32_VMA)
   216 00000077 68[00000000]                push dword(__CR3_KERNEL)  
   217 0000007C E8(00000000)                call set_dtp_pt_merged_rom
   218 00000081 C9                          leave
   219                                      ;;
   220 00000082 55                          push    ebp
   221 00000083 89E5                        mov     ebp, esp
   222 00000085 6A01                        push SUP_R_P     
   223 00000087 68[00000000]                push dword(__FUNCTIONS_PHY)
   224 0000008C 68[00000000]                push dword(__FUNCTIONS_VMA)
   225 00000091 68[00000000]                push dword(__CR3_KERNEL)  
   226 00000096 E8(00000000)                call set_dtp_pt_merged_rom
   227 0000009B C9                          leave
   228                                      ;;
   229 0000009C 55                          push    ebp
   230 0000009D 89E5                        mov     ebp, esp
   231 0000009F 6A03                        push SUP_W_P     
   232 000000A1 68[00000000]                push dword(__SYS_TABLES_PHY)
   233 000000A6 68[00000000]                push dword(__SYS_TABLES_VMA)
   234 000000AB 68[00000000]                push dword(__CR3_KERNEL) 
   235 000000B0 E8(00000000)                call set_dtp_pt_merged_rom
   236 000000B5 C9                          leave
   237                                      ;;    
   238 000000B6 55                          push    ebp
   239 000000B7 89E5                        mov     ebp, esp
   240 000000B9 6A03                        push SUP_W_P     
   241 000000BB 68[00000000]                push dword(__SYS_TABLES_TSS_PHY)
   242 000000C0 68[00000000]                push dword(__SYS_TABLES_TSS_VMA)
   243 000000C5 68[00000000]                push dword(__CR3_KERNEL) 
   244 000000CA E8(00000000)                call set_dtp_pt_merged_rom
   245 000000CF C9                          leave 
   246                                      ;;
   247 000000D0 55                          push    ebp
   248 000000D1 89E5                        mov     ebp, esp
   249 000000D3 6A03                        push SUP_W_P     
   250 000000D5 68[00000000]                push dword(__SYS_TABLES_PAG_PHY)
   251 000000DA 68[00000000]                push dword(__SYS_TABLES_PAG_VMA)
   252 000000DF 68[00000000]                push dword(__CR3_KERNEL)  
   253 000000E4 E8(00000000)                call set_dtp_pt_merged_rom
   254 000000E9 C9                          leave 
   255                                      ;;    
   256 000000EA 55                          push    ebp
   257 000000EB 89E5                        mov     ebp, esp
   258 000000ED 6A03                        push SUP_W_P     
   259 000000EF 68[00000000]                push dword(__VIDEO_PHY)
   260 000000F4 68[00000000]                push dword(__VIDEO_VMA)
   261 000000F9 68[00000000]                push dword(__CR3_KERNEL)  
   262 000000FE E8(00000000)                call set_dtp_pt_merged_rom
   263 00000103 C9                          leave
   264                                      ;;   
   265 00000104 55                          push    ebp
   266 00000105 89E5                        mov     ebp, esp
   267 00000107 6A03                        push SUP_W_P     
   268 00000109 68[00000000]                push dword(__DATA_PHY)
   269 0000010E 68[00000000]                push dword(__DATA_VMA)
   270 00000113 68[00000000]                push dword(__CR3_KERNEL)  
   271 00000118 E8(00000000)                call set_dtp_pt_merged_rom
   272 0000011D C9                          leave 
   273                                      ;;
   274 0000011E 55                          push    ebp
   275 0000011F 89E5                        mov     ebp, esp
   276 00000121 6A03                        push SUP_W_P     
   277 00000123 68[00000000]                push dword(__STACK_START_32_PHY)
   278 00000128 68[00000000]                push dword(__STACK_START_32)
   279 0000012D 68[00000000]                push dword(__CR3_KERNEL)  
   280 00000132 E8(00000000)                call set_dtp_pt_merged_rom
   281 00000137 C9                          leave
   282                                      ;;
   283                                      ;;
   284 00000138 55                          push    ebp
   285 00000139 89E5                        mov     ebp, esp
   286 0000013B 6A07                        push US_W_P     
   287 0000013D 68[00000000]                push dword(__STACK_TASK1_PHY)
   288 00000142 68[00000000]                push dword(__STACK_TASK1_VMA)
   289 00000147 68[00000000]                push dword(__CR3_KERNEL)  
   290 0000014C E8(00000000)                call set_dtp_pt_merged_rom
   291 00000151 C9                          leave
   292                                      ;;
   293 00000152 55                          push    ebp
   294 00000153 89E5                        mov     ebp, esp
   295 00000155 6A07                        push US_W_P     
   296 00000157 68[00000000]                push dword(__TABLE_KEYBOARD_PHY)
   297 0000015C 68[00000000]                push dword(__TABLE_KEYBOARD_VMA)
   298 00000161 68[00000000]                push dword(__CR3_KERNEL)  
   299 00000166 E8(00000000)                call set_dtp_pt_merged_rom
   300 0000016B C9                          leave
   301                                      ;;
   302 0000016C 55                          push    ebp
   303 0000016D 89E5                        mov     ebp, esp
   304 0000016F 6A03                        push SUP_W_P
   305 00000171 68[00000000]                push dword(__FUNCTIONS_ROM_LMA) ; Rom init
   306 00000176 68[00000000]                push dword(__FUNCTIONS_ROM_LMA)
   307 0000017B 68[00000000]                push dword(__CR3_KERNEL)          
   308 00000180 E8(00000000)                call set_dtp_pt_merged_rom
   309 00000185 C9                          leave
   310                                      ;;
   311                                      ; CHEQUEAR ESTO!!**
   312 00000186 55                          push    ebp
   313 00000187 89E5                        mov     ebp, esp
   314 00000189 6A03                        push SUP_W_P
   315 0000018B 68[00000000]                push dword(__INIT_32_VMA) ; Rom init
   316 00000190 68[00000000]                push dword(__INIT_32_VMA)
   317 00000195 68[00000000]                push dword(__CR3_KERNEL)          
   318 0000019A E8(00000000)                call set_dtp_pt_merged_rom
   319 0000019F C9                          leave
   320                                      ;;
   321 000001A0 55                              push    ebp
   322 000001A1 89E5                        mov     ebp, esp
   323 000001A3 6A03                        push SUP_W_P
   324 000001A5 68[00100000]                push dword(__INIT_32_VMA+0x1000) ; Rom init
   325 000001AA 68[00100000]                push dword(__INIT_32_VMA+0x1000)
   326 000001AF 68[00000000]                push dword(__CR3_KERNEL)          
   327 000001B4 E8(00000000)                call set_dtp_pt_merged_rom
   328 000001B9 C9                          leave
   329                                      ;;       TASK1
   330 000001BA 55                          push    ebp
   331 000001BB 89E5                        mov     ebp, esp                                            
   332 000001BD 6A01                        push SUP_R_P
   333 000001BF 68[00000000]                push dword(__ISR_AND_KEYBOARD_PHY)
   334 000001C4 68[00000000]                push dword(__ISR_AND_KEYBOARD_VMA)
   335 000001C9 68[00000000]                push dword(__CR3_TASK1)         
   336 000001CE E8(00000000)                call set_dtp_pt_merged_rom
   337 000001D3 C9                          leave                       
   338                                      ;;
   339 000001D4 55                          push    ebp
   340 000001D5 89E5                        mov     ebp, esp                                     
   341 000001D7 6A01                        push SUP_R_P;US_R_P;
   342 000001D9 68[00000000]                push dword(__FUNCTIONS_PHY)
   343 000001DE 68[00000000]                push dword(__FUNCTIONS_VMA)
   344 000001E3 68[00000000]                push dword(__CR3_TASK1)         
   345 000001E8 E8(00000000)                call set_dtp_pt_merged_rom
   346 000001ED C9                          leave                  
   347                                      ;;
   348 000001EE 55                          push    ebp
   349 000001EF 89E5                        mov     ebp, esp                    
   350 000001F1 6A03                        push SUP_W_P                        
   351 000001F3 68[00000000]                push dword(__SYS_TABLES_TSS_PHY)            
   352 000001F8 68[00000000]                push dword(__SYS_TABLES_TSS_VMA)            
   353 000001FD 68[00000000]                push dword(__CR3_TASK1)                       
   354 00000202 E8(00000000)                call set_dtp_pt_merged_rom
   355 00000207 C9                          leave
   356                                      ;;
   357 00000208 55                          push    ebp
   358 00000209 89E5                        mov     ebp, esp                                          
   359 0000020B 6A03                        push SUP_W_P;
   360 0000020D 68[00000000]                push dword(__VIDEO_PHY)
   361 00000212 68[00000000]                push dword(__VIDEO_VMA)
   362 00000217 68[00000000]                push dword(__CR3_TASK1)               
   363 0000021C E8(00000000)                call set_dtp_pt_merged_rom
   364 00000221 C9                          leave
   365                                      ;;
   366 00000222 55                          push    ebp
   367 00000223 89E5                        mov     ebp, esp                                          
   368 00000225 6A03                        push SUP_W_P
   369 00000227 68[00000000]                push dword(__DATA_PHY)
   370 0000022C 68[00000000]                push dword(__DATA_VMA)
   371 00000231 68[00000000]                push dword(__CR3_TASK1)                           
   372 00000236 E8(00000000)                call set_dtp_pt_merged_rom
   373 0000023B C9                          leave
   374                                      ;;
   375 0000023C 55                          push    ebp
   376 0000023D 89E5                        mov     ebp, esp
   377 0000023F 6A03                        push SUP_W_P     
   378 00000241 68[00000000]                push dword(__STACK_KERNEL_T1_PHY)
   379 00000246 68[00000000]                push dword(__STACK_KERNEL_T1_VMA)
   380 0000024B 68[00000000]                push dword(__CR3_TASK1)  
   381 00000250 E8(00000000)                call set_dtp_pt_merged_rom
   382 00000255 C9                          leave       
   383                                      ;;
   384 00000256 55                          push    ebp
   385 00000257 89E5                        mov     ebp, esp
   386 00000259 6A03                        push SUP_W_P
   387 0000025B 68[00000000]                push dword(__STACK_START_32_PHY)
   388 00000260 68[00000000]                push dword(__STACK_START_32)
   389 00000265 68[00000000]                push dword(__CR3_TASK1)           
   390 0000026A E8(00000000)                call set_dtp_pt_merged_rom
   391 0000026F C9                          leave
   392                                      ;;
   393 00000270 55                          push    ebp
   394 00000271 89E5                        mov     ebp, esp
   395 00000273 6A05                        push US_R_P;SUP_R_P ;
   396 00000275 68[00000000]                push dword(__TASK_1_TEXT_PHY)
   397 0000027A 68[00000000]                push dword(__TASK_1_TEXT_VMA)
   398 0000027F 68[00000000]                push dword(__CR3_TASK1)           
   399 00000284 E8(00000000)                call set_dtp_pt_merged_rom
   400 00000289 C9                          leave
   401                                      ;;
   402 0000028A 55                          push    ebp
   403 0000028B 89E5                        mov     ebp, esp
   404 0000028D 6A05                        push US_R_P;SUP_R_P;
   405 0000028F 68[00000000]                push dword(__TASK_1_RODATA_PHY)
   406 00000294 68[00000000]                push dword(__TASK_1_RODATA_VMA)
   407 00000299 68[00000000]                push dword(__CR3_TASK1)           
   408 0000029E E8(00000000)                call set_dtp_pt_merged_rom
   409 000002A3 C9                          leave
   410                                      ;;
   411 000002A4 55                          push    ebp
   412 000002A5 89E5                        mov     ebp, esp
   413 000002A7 6A07                        push US_W_P                                            
   414 000002A9 68[00000000]                push dword(__SYS_TABLES_PHY)
   415 000002AE 68[00000000]                push dword(__SYS_TABLES_VMA)                         
   416 000002B3 68[00000000]                push dword(__CR3_TASK1)                   
   417 000002B8 E8(00000000)                call set_dtp_pt_merged_rom
   418 000002BD C9                          leave
   419                                      ;;   
   420 000002BE 55                          push    ebp
   421 000002BF 89E5                        mov     ebp, esp
   422 000002C1 6A07                        push US_W_P
   423 000002C3 68[00000000]                push dword(__SYS_TABLES_PAG_T1_PHY)
   424 000002C8 68[00000000]                push dword(__SYS_TABLES_PAG_T1_VMA)
   425 000002CD 68[00000000]                push dword(__CR3_TASK1)         
   426 000002D2 E8(00000000)                call set_dtp_pt_merged_rom
   427 000002D7 C9                          leave
   428                                      ;;
   429 000002D8 55                          push    ebp
   430 000002D9 89E5                        mov     ebp, esp                               
   431 000002DB 6A07                        push US_W_P
   432 000002DD 68[00000000]                push dword(__TABLE_KEYBOARD_PHY)
   433 000002E2 68[00000000]                push dword(__TABLE_KEYBOARD_VMA)
   434 000002E7 68[00000000]                push dword(__CR3_TASK1)                    
   435 000002EC E8(00000000)                call set_dtp_pt_merged_rom
   436 000002F1 C9                          leave
   437                                      ;;
   438 000002F2 55                          push    ebp
   439 000002F3 89E5                        mov     ebp, esp
   440 000002F5 6A07                        push US_W_P
   441 000002F7 68[00000000]                push dword(__TASK_1_BSS_PHY)
   442 000002FC 68[00000000]                push dword(__TASK_1_BSS_VMA)
   443 00000301 68[00000000]                push dword(__CR3_TASK1)           
   444 00000306 E8(00000000)                call set_dtp_pt_merged_rom
   445 0000030B C9                          leave
   446                                      ;;
   447 0000030C 55                          push    ebp
   448 0000030D 89E5                        mov     ebp, esp
   449 0000030F 6A07                        push US_W_P
   450 00000311 68[00000000]                push dword(__TASK_1_DATA_PHY)
   451 00000316 68[00000000]                push dword(__TASK_1_DATA_VMA)
   452 0000031B 68[00000000]                push dword(__CR3_TASK1)           
   453 00000320 E8(00000000)                call set_dtp_pt_merged_rom
   454 00000325 C9                          leave
   455                                      ;;
   456 00000326 55                          push    ebp
   457 00000327 89E5                        mov     ebp, esp
   458 00000329 6A07                        push US_W_P
   459 0000032B 68[00000000]                push dword(__STACK_TASK1_PHY)
   460 00000330 68[00000000]                push dword(__STACK_TASK1_VMA)
   461 00000335 68[00000000]                push dword(__CR3_TASK1)           
   462 0000033A E8(00000000)                call set_dtp_pt_merged_rom
   463 0000033F C9                          leave
   464                                  
   465                                  
   466                                  ;------------------TASK 2-----------------
   467                                  
   468 00000340 55                          push    ebp
   469 00000341 89E5                        mov     ebp, esp
   470 00000343 6A01                        push SUP_R_P                        
   471 00000345 68[00000000]                push dword(__SYS_TABLES_PHY)                 
   472 0000034A 68[00000000]                push dword(__SYS_TABLES_VMA)              
   473 0000034F 68[00000000]                push dword(__CR3_TASK2)                   
   474 00000354 E8(00000000)                call set_dtp_pt_merged_rom
   475 00000359 C9                          leave
   476                                      ;;
   477 0000035A 55                          push    ebp
   478 0000035B 89E5                        mov     ebp, esp                                           
   479 0000035D 6A01                        push SUP_R_P
   480 0000035F 68[00000000]                push dword(__ISR_AND_KEYBOARD_PHY)
   481 00000364 68[00000000]                push dword(__ISR_AND_KEYBOARD_VMA)
   482 00000369 68[00000000]                push dword(__CR3_TASK2)         
   483 0000036E E8(00000000)                call set_dtp_pt_merged_rom 
   484 00000373 C9                          leave                     
   485                                      ;;
   486 00000374 55                          push    ebp
   487 00000375 89E5                        mov     ebp, esp                                      
   488 00000377 6A01                        push SUP_R_P;US_R_P;
   489 00000379 68[00000000]                push dword(__FUNCTIONS_PHY)
   490 0000037E 68[00000000]                push dword(__FUNCTIONS_VMA)
   491 00000383 68[00000000]                push dword(__CR3_TASK2)         
   492 00000388 E8(00000000)                call set_dtp_pt_merged_rom
   493 0000038D C9                          leave                  
   494                                      ;;
   495 0000038E 55                          push    ebp
   496 0000038F 89E5                        mov     ebp, esp
   497 00000391 6A03                        push SUP_W_P                                                   
   498 00000393 68[00000000]                push dword(__SYS_TABLES_TSS_PHY)               
   499 00000398 68[00000000]                push dword(__SYS_TABLES_TSS_VMA)               
   500 0000039D 68[00000000]                push dword(__CR3_TASK2)                       
   501 000003A2 E8(00000000)                call set_dtp_pt_merged_rom
   502 000003A7 C9                          leave
   503                                      ;;
   504 000003A8 55                          push    ebp
   505 000003A9 89E5                        mov     ebp, esp
   506 000003AB 6A03                        push SUP_W_P
   507 000003AD 68[00000000]                push dword(__SYS_TABLES_PAG_T2_PHY)
   508 000003B2 68[00000000]                push dword(__SYS_TABLES_PAG_T2_VMA)
   509 000003B7 68[00000000]                push dword(__CR3_TASK2)         
   510 000003BC E8(00000000)                call set_dtp_pt_merged_rom
   511 000003C1 C9                          leave
   512                                      ;;    
   513 000003C2 55                          push    ebp
   514 000003C3 89E5                        mov     ebp, esp                                
   515 000003C5 6A03                        push SUP_W_P;US_W_P;
   516 000003C7 68[00000000]                push dword(__VIDEO_PHY)
   517 000003CC 68[00000000]                push dword(__VIDEO_VMA)
   518 000003D1 68[00000000]                push dword(__CR3_TASK2)               
   519 000003D6 E8(00000000)                call set_dtp_pt_merged_rom
   520 000003DB C9                          leave
   521                                      ;;
   522 000003DC 55                          push    ebp
   523 000003DD 89E5                        mov     ebp, esp                                          
   524 000003DF 6A03                        push SUP_W_P
   525 000003E1 68[00000000]                push dword(__DATA_PHY)
   526 000003E6 68[00000000]                push dword(__DATA_VMA)
   527 000003EB 68[00000000]                push dword(__CR3_TASK2)                           
   528 000003F0 E8(00000000)                call set_dtp_pt_merged_rom
   529 000003F5 C9                          leave
   530                                      ;;
   531 000003F6 55                          push    ebp
   532 000003F7 89E5                        mov     ebp, esp
   533 000003F9 6A03                        push SUP_W_P     
   534 000003FB 68[00000000]                push dword(__STACK_KERNEL_T2_PHY)
   535 00000400 68[00000000]                push dword(__STACK_KERNEL_T2_VMA)
   536 00000405 68[00000000]                push dword(__CR3_TASK2)  
   537 0000040A E8(00000000)                call set_dtp_pt_merged_rom
   538 0000040F C9                          leave  
   539                                      ;;
   540 00000410 55                          push    ebp
   541 00000411 89E5                        mov     ebp, esp
   542 00000413 6A03                        push SUP_W_P
   543 00000415 68[00000000]                push dword(__STACK_START_32_PHY)
   544 0000041A 68[00000000]                push dword(__STACK_START_32)
   545 0000041F 68[00000000]                push dword(__CR3_TASK2)           
   546 00000424 E8(00000000)                call set_dtp_pt_merged_rom
   547 00000429 C9                          leave
   548                                      ;;
   549 0000042A 55                          push    ebp
   550 0000042B 89E5                        mov     ebp, esp
   551 0000042D 6A05                        push US_R_P;SUP_R_P;
   552 0000042F 68[00000000]                push dword(__TASK_2_TEXT_PHY)
   553 00000434 68[00000000]                push dword(__TASK_2_TEXT_VMA)
   554 00000439 68[00000000]                push dword(__CR3_TASK2)           
   555 0000043E E8(00000000)                call set_dtp_pt_merged_rom
   556 00000443 C9                          leave
   557                                      ;;
   558 00000444 55                          push    ebp
   559 00000445 89E5                        mov     ebp, esp
   560 00000447 6A05                        push US_R_P
   561 00000449 68[00000000]                push dword(__TASK_2_RODATA_PHY)
   562 0000044E 68[00000000]                push dword(__TASK_2_RODATA_VMA)
   563 00000453 68[00000000]                push dword(__CR3_TASK2)           
   564 00000458 E8(00000000)                call set_dtp_pt_merged_rom
   565 0000045D C9                          leave
   566                                      ;;
   567 0000045E 55                          push    ebp
   568 0000045F 89E5                        mov     ebp, esp                              
   569 00000461 6A07                        push US_W_P
   570 00000463 68[00000000]                push dword(__TABLE_KEYBOARD_PHY)
   571 00000468 68[00000000]                push dword(__TABLE_KEYBOARD_VMA)
   572 0000046D 68[00000000]                push dword(__CR3_TASK2)                    
   573 00000472 E8(00000000)                call set_dtp_pt_merged_rom
   574 00000477 C9                          leave
   575                                      ;;   
   576 00000478 55                          push    ebp
   577 00000479 89E5                        mov     ebp, esp 
   578 0000047B 6A07                        push US_W_P
   579 0000047D 68[00000000]                push dword(__TASK_2_BSS_PHY)
   580 00000482 68[00000000]                push dword(__TASK_2_BSS_VMA)
   581 00000487 68[00000000]                push dword(__CR3_TASK2)            
   582 0000048C E8(00000000)                call set_dtp_pt_merged_rom
   583 00000491 C9                          leave
   584                                      ;;
   585 00000492 55                          push    ebp
   586 00000493 89E5                        mov     ebp, esp 
   587 00000495 6A07                        push US_W_P
   588 00000497 68[00000000]                push dword(__TASK_2_DATA_PHY)
   589 0000049C 68[00000000]                push dword(__TASK_2_DATA_VMA)
   590 000004A1 68[00000000]                push dword(__CR3_TASK2)           
   591 000004A6 E8(00000000)                call set_dtp_pt_merged_rom
   592 000004AB C9                          leave 
   593                                      ;;
   594 000004AC 55                          push    ebp
   595 000004AD 89E5                        mov     ebp, esp 
   596 000004AF 6A07                        push US_W_P  
   597 000004B1 68[00000000]                push dword(__STACK_TASK2_PHY)
   598 000004B6 68[00000000]                push dword(__STACK_TASK2_VMA)
   599 000004BB 68[00000000]                push dword(__CR3_TASK2)            
   600 000004C0 E8(00000000)                call set_dtp_pt_merged_rom
   601 000004C5 C9                          leave    
   602                                  
   603                                  ;------------------TASK 3-----------------
   604                                  
   605 000004C6 55                          push    ebp
   606 000004C7 89E5                        mov     ebp, esp 
   607 000004C9 6A01                        push SUP_R_P                                      
   608 000004CB 68[00000000]                push dword(__SYS_TABLES_PHY)                
   609 000004D0 68[00000000]                push dword(__SYS_TABLES_VMA )                 
   610 000004D5 68[00000000]                push dword(__CR3_TASK3)                   
   611 000004DA E8(00000000)                call set_dtp_pt_merged_rom
   612 000004DF C9                          leave
   613                                      ;;
   614 000004E0 55                          push    ebp
   615 000004E1 89E5                        mov     ebp, esp                                           
   616 000004E3 6A01                        push SUP_R_P;US_W_P;
   617 000004E5 68[00000000]                push dword(__VIDEO_PHY)
   618 000004EA 68[00000000]                push dword(__VIDEO_VMA)
   619 000004EF 68[00000000]                push dword(__CR3_TASK3)               
   620 000004F4 E8(00000000)                call set_dtp_pt_merged_rom
   621 000004F9 C9                          leave
   622                                      ;;
   623 000004FA 55                          push    ebp
   624 000004FB 89E5                        mov     ebp, esp                                            
   625 000004FD 6A01                        push SUP_R_P
   626 000004FF 68[00000000]                push dword(__ISR_AND_KEYBOARD_PHY)
   627 00000504 68[00000000]                push dword(__ISR_AND_KEYBOARD_VMA)
   628 00000509 68[00000000]                push dword(__CR3_TASK3)         
   629 0000050E E8(00000000)                call set_dtp_pt_merged_rom                       
   630 00000513 C9                          leave
   631                                      ;;
   632 00000514 55                          push    ebp
   633 00000515 89E5                        mov     ebp, esp                                       
   634 00000517 6A01                        push SUP_R_P;US_R_P;
   635 00000519 68[00000000]                push dword(__FUNCTIONS_PHY)
   636 0000051E 68[00000000]                push dword(__FUNCTIONS_VMA)
   637 00000523 68[00000000]                push dword(__CR3_TASK3)         
   638 00000528 E8(00000000)                call set_dtp_pt_merged_rom                   
   639 0000052D C9                          leave
   640                                      ;;
   641 0000052E 55                          push    ebp
   642 0000052F 89E5                        mov     ebp, esp 
   643 00000531 6A03                        push SUP_W_P                                            
   644 00000533 68[00000000]                push dword(__SYS_TABLES_TSS_PHY)               
   645 00000538 68[00000000]                push dword(__SYS_TABLES_TSS_VMA)              
   646 0000053D 68[00000000]                push dword(__CR3_TASK3)                       
   647 00000542 E8(00000000)                call set_dtp_pt_merged_rom
   648 00000547 C9                          leave
   649                                      ;;
   650 00000548 55                          push    ebp
   651 00000549 89E5                        mov     ebp, esp 
   652 0000054B 6A03                        push SUP_W_P
   653 0000054D 68[00000000]                push dword(__SYS_TABLES_PAG_T3_PHY)
   654 00000552 68[00000000]                push dword(__SYS_TABLES_PAG_T3_VMA)
   655 00000557 68[00000000]                push dword(__CR3_TASK3)         
   656 0000055C E8(00000000)                call set_dtp_pt_merged_rom
   657 00000561 C9                          leave
   658                                      ;;
   659 00000562 55                          push    ebp
   660 00000563 89E5                        mov     ebp, esp                                           
   661 00000565 6A03                        push SUP_W_P
   662 00000567 68[00000000]                push dword(__DATA_PHY)
   663 0000056C 68[00000000]                push dword(__DATA_VMA)
   664 00000571 68[00000000]                push dword(__CR3_TASK3)                           
   665 00000576 E8(00000000)                call set_dtp_pt_merged_rom
   666 0000057B C9                          leave
   667                                      ;;
   668 0000057C 55                          push    ebp
   669 0000057D 89E5                        mov     ebp, esp
   670 0000057F 6A03                        push SUP_W_P     
   671 00000581 68[00000000]                push dword(__STACK_KERNEL_T3_PHY)
   672 00000586 68[00000000]                push dword(__STACK_KERNEL_T3_VMA)
   673 0000058B 68[00000000]                push dword(__CR3_TASK3)  
   674 00000590 E8(00000000)                call set_dtp_pt_merged_rom
   675 00000595 C9                          leave
   676                                      ;;  
   677 00000596 55                          push    ebp
   678 00000597 89E5                        mov     ebp, esp 
   679 00000599 6A03                        push SUP_W_P
   680 0000059B 68[00000000]                push dword(__STACK_START_32_PHY)
   681 000005A0 68[00000000]                push dword(__STACK_START_32)
   682 000005A5 68[00000000]                push dword(__CR3_TASK3)           
   683 000005AA E8(00000000)                call set_dtp_pt_merged_rom
   684 000005AF C9                          leave
   685                                      ;;
   686 000005B0 55                          push    ebp
   687 000005B1 89E5                        mov     ebp, esp 
   688 000005B3 6A05                        push US_R_P;SUP_R_P;
   689 000005B5 68[00000000]                push dword(__TASK_3_TEXT_PHY)
   690 000005BA 68[00000000]                push dword(__TASK_3_TEXT_VMA)
   691 000005BF 68[00000000]                push dword(__CR3_TASK3)           
   692 000005C4 E8(00000000)                call set_dtp_pt_merged_rom
   693 000005C9 C9                          leave
   694                                      ;;
   695 000005CA 55                          push    ebp
   696 000005CB 89E5                        mov     ebp, esp 
   697 000005CD 6A05                        push US_R_P
   698 000005CF 68[00000000]                push dword(__TASK_3_RODATA_PHY)
   699 000005D4 68[00000000]                push dword(__TASK_3_RODATA_VMA)
   700 000005D9 68[00000000]                push dword(__CR3_TASK3)           
   701 000005DE E8(00000000)                call set_dtp_pt_merged_rom
   702 000005E3 C9                          leave
   703                                      ;;
   704 000005E4 55                          push    ebp
   705 000005E5 89E5                        mov     ebp, esp                                
   706 000005E7 6A07                        push US_W_P
   707 000005E9 68[00000000]                push dword(__TABLE_KEYBOARD_PHY)
   708 000005EE 68[00000000]                push dword(__TABLE_KEYBOARD_VMA)
   709 000005F3 68[00000000]                push dword(__CR3_TASK3)                    
   710 000005F8 E8(00000000)                call set_dtp_pt_merged_rom
   711 000005FD C9                          leave
   712                                      ;;
   713 000005FE 55                          push    ebp
   714 000005FF 89E5                        mov     ebp, esp 
   715 00000601 6A07                        push US_W_P
   716 00000603 68[00000000]                push dword( __TASK_3_BSS_PHY)
   717 00000608 68[00000000]                push dword(__TASK_3_BSS_VMA)
   718 0000060D 68[00000000]                push dword(__CR3_TASK3)           
   719 00000612 E8(00000000)                call set_dtp_pt_merged_rom
   720 00000617 C9                          leave
   721                                      ;;
   722 00000618 55                          push    ebp
   723 00000619 89E5                        mov     ebp, esp 
   724 0000061B 6A07                        push US_W_P
   725 0000061D 68[00000000]                push dword(__TASK_3_DATA_PHY)
   726 00000622 68[00000000]                push dword(__TASK_3_DATA_VMA)
   727 00000627 68[00000000]                push dword(__CR3_TASK3)           
   728 0000062C E8(00000000)                call set_dtp_pt_merged_rom
   729 00000631 C9                          leave
   730                                      ;;
   731 00000632 55                          push    ebp
   732 00000633 89E5                        mov     ebp, esp 
   733 00000635 6A07                        push US_W_P  
   734 00000637 68[00000000]                push dword(__STACK_TASK3_PHY)
   735 0000063C 68[00000000]                push dword(__STACK_TASK3_VMA)
   736 00000641 68[00000000]                push dword(__CR3_TASK3)           
   737 00000646 E8(00000000)                call set_dtp_pt_merged_rom
   738 0000064B C9                          leave
   739                                  
   740                                  
   741                                  ;------------------TASK 4-----------------
   742                                  
   743 0000064C 55                          push    ebp
   744 0000064D 89E5                        mov     ebp, esp 
   745 0000064F 6A01                        push SUP_R_P                                      
   746 00000651 68[00000000]                push dword(__SYS_TABLES_PHY)                
   747 00000656 68[00000000]                push dword(__SYS_TABLES_VMA )                 
   748 0000065B 68[00000000]                push dword(__CR3_TASK4)                   
   749 00000660 E8(00000000)                call set_dtp_pt_merged_rom
   750 00000665 C9                          leave
   751                                      ;;
   752 00000666 55                          push    ebp
   753 00000667 89E5                        mov     ebp, esp                                           
   754 00000669 6A07                        push US_W_P;SUP_R_P
   755 0000066B 68[00000000]                push dword(__VIDEO_PHY)
   756 00000670 68[00000000]                push dword(__VIDEO_VMA)
   757 00000675 68[00000000]                push dword(__CR3_TASK4)               
   758 0000067A E8(00000000)                call set_dtp_pt_merged_rom
   759 0000067F C9                          leave
   760                                      ;;
   761 00000680 55                          push    ebp
   762 00000681 89E5                        mov     ebp, esp                                            
   763 00000683 6A01                        push SUP_R_P
   764 00000685 68[00000000]                push dword(__ISR_AND_KEYBOARD_PHY)
   765 0000068A 68[00000000]                push dword(__ISR_AND_KEYBOARD_VMA)
   766 0000068F 68[00000000]                push dword(__CR3_TASK4)         
   767 00000694 E8(00000000)                call set_dtp_pt_merged_rom                       
   768 00000699 C9                          leave
   769                                      ;;
   770 0000069A 55                          push    ebp
   771 0000069B 89E5                        mov     ebp, esp                                       
   772 0000069D 6A05                        push US_R_P;SUP_R_P
   773 0000069F 68[00000000]                push dword(__FUNCTIONS_PHY)
   774 000006A4 68[00000000]                push dword(__FUNCTIONS_VMA)
   775 000006A9 68[00000000]                push dword(__CR3_TASK4)         
   776 000006AE E8(00000000)                call set_dtp_pt_merged_rom                   
   777 000006B3 C9                          leave
   778                                      ;;
   779 000006B4 55                          push    ebp
   780 000006B5 89E5                        mov     ebp, esp 
   781 000006B7 6A03                        push SUP_W_P                                            
   782 000006B9 68[00000000]                push dword(__SYS_TABLES_TSS_PHY)               
   783 000006BE 68[00000000]                push dword(__SYS_TABLES_TSS_VMA)              
   784 000006C3 68[00000000]                push dword(__CR3_TASK4)                       
   785 000006C8 E8(00000000)                call set_dtp_pt_merged_rom
   786 000006CD C9                          leave
   787                                      ;;
   788 000006CE 55                          push    ebp
   789 000006CF 89E5                        mov     ebp, esp 
   790 000006D1 6A03                        push SUP_W_P
   791 000006D3 68[00000000]                push dword(__SYS_TABLES_PAG_T4_PHY)
   792 000006D8 68[00000000]                push dword(__SYS_TABLES_PAG_T4_VMA)
   793 000006DD 68[00000000]                push dword(__CR3_TASK4)         
   794 000006E2 E8(00000000)                call set_dtp_pt_merged_rom
   795 000006E7 C9                          leave
   796                                      ;;
   797 000006E8 55                          push    ebp
   798 000006E9 89E5                        mov     ebp, esp                                           
   799 000006EB 6A03                        push SUP_W_P
   800 000006ED 68[00000000]                push dword(__DATA_PHY)
   801 000006F2 68[00000000]                push dword(__DATA_VMA)
   802 000006F7 68[00000000]                push dword(__CR3_TASK4)                           
   803 000006FC E8(00000000)                call set_dtp_pt_merged_rom
   804 00000701 C9                          leave
   805                                      ;;
   806 00000702 55                          push    ebp
   807 00000703 89E5                        mov     ebp, esp
   808 00000705 6A03                        push SUP_W_P     
   809 00000707 68[00000000]                push dword(__STACK_KERNEL_T4_PHY)
   810 0000070C 68[00000000]                push dword(__STACK_KERNEL_T4_VMA)
   811 00000711 68[00000000]                push dword(__CR3_TASK4)  
   812 00000716 E8(00000000)                call set_dtp_pt_merged_rom
   813 0000071B C9                          leave
   814                                      ;;
   815 0000071C 55                          push    ebp
   816 0000071D 89E5                        mov     ebp, esp 
   817 0000071F 6A03                        push SUP_W_P
   818 00000721 68[00000000]                push dword(__STACK_START_32_PHY)
   819 00000726 68[00000000]                push dword(__STACK_START_32)
   820 0000072B 68[00000000]                push dword(__CR3_TASK4)           
   821 00000730 E8(00000000)                call set_dtp_pt_merged_rom
   822 00000735 C9                          leave
   823                                      ;;
   824 00000736 55                          push    ebp
   825 00000737 89E5                        mov     ebp, esp 
   826 00000739 6A01                        push SUP_R_P ; US_R_P
   827 0000073B 68[00000000]                push dword(__TASK_4_TEXT_PHY)
   828 00000740 68[00000000]                push dword(__TASK_4_TEXT_VMA)
   829 00000745 68[00000000]                push dword(__CR3_TASK4)           
   830 0000074A E8(00000000)                call set_dtp_pt_merged_rom
   831 0000074F C9                          leave
   832                                      ;;
   833 00000750 55                          push    ebp
   834 00000751 89E5                        mov     ebp, esp 
   835 00000753 6A01                        push SUP_R_P
   836 00000755 68[00000000]                push dword(__TASK_4_RODATA_PHY)
   837 0000075A 68[00000000]                push dword(__TASK_4_RODATA_VMA)
   838 0000075F 68[00000000]                push dword(__CR3_TASK4)           
   839 00000764 E8(00000000)                call set_dtp_pt_merged_rom
   840 00000769 C9                          leave
   841                                      ;;
   842 0000076A 55                          push    ebp
   843 0000076B 89E5                        mov     ebp, esp                                
   844 0000076D 6A07                        push US_W_P
   845 0000076F 68[00000000]                push dword(__TABLE_KEYBOARD_PHY)
   846 00000774 68[00000000]                push dword(__TABLE_KEYBOARD_VMA)
   847 00000779 68[00000000]                push dword(__CR3_TASK4)                    
   848 0000077E E8(00000000)                call set_dtp_pt_merged_rom
   849 00000783 C9                          leave
   850                                      ;;
   851 00000784 55                          push    ebp
   852 00000785 89E5                        mov     ebp, esp 
   853 00000787 6A03                        push SUP_W_P
   854 00000789 68[00000000]                push dword( __TASK_4_BSS_PHY)
   855 0000078E 68[00000000]                push dword(__TASK_4_BSS_VMA)
   856 00000793 68[00000000]                push dword(__CR3_TASK4)           
   857 00000798 E8(00000000)                call set_dtp_pt_merged_rom
   858 0000079D C9                          leave
   859                                      ;;
   860 0000079E 55                          push    ebp
   861 0000079F 89E5                        mov     ebp, esp 
   862 000007A1 6A03                        push SUP_W_P
   863 000007A3 68[00000000]                push dword(__TASK_4_DATA_PHY)
   864 000007A8 68[00000000]                push dword(__TASK_4_DATA_VMA)
   865 000007AD 68[00000000]                push dword(__CR3_TASK4)           
   866 000007B2 E8(00000000)                call set_dtp_pt_merged_rom
   867 000007B7 C9                          leave
   868                                      ;;
   869 000007B8 55                          push    ebp
   870 000007B9 89E5                        mov     ebp, esp 
   871 000007BB 6A03                        push SUP_W_P ;US_W_P  
   872 000007BD 68[00000000]                push dword(__STACK_TASK4_PHY)
   873 000007C2 68[00000000]                push dword(__STACK_TASK4_VMA)
   874 000007C7 68[00000000]                push dword(__CR3_TASK4)           
   875 000007CC E8(00000000)                call set_dtp_pt_merged_rom
   876 000007D1 C9                          leave
   877                                  
   878                                  
   879                                      ;; Ready to turn on paging, say touching CR registers, go on
   880                                      
   881 000007D2 E9(00000000)                jmp TURN_ON_PAGING ; Return ready to turn on paging
